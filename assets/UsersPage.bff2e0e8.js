import{Q as M}from"./QHeader.a86634a6.js";import{Q as k}from"./QDrawer.ba86ac57.js";import{L as V,a as S,u as C,D as x,t as L,o as v,f as g,w as t,P as a,g as l,Q as i,U as $,a4 as Q,R as b,K as w,aO as T,e as q,M as z,O as E,N as D,_ as O,a5 as j,aP as P,aQ as G,aR as F,T as R}from"./index.c0f6129f.js";import{Q as I,a as Z}from"./QToolbar.a926ce6b.js";import{b as p,c as f,Q as y,a as H}from"./QCardActions.e06cbccf.js";import{Q as J}from"./QPage.d14942cf.js";import{c as U,a as A,b as _,Q as K}from"./QList.291bd828.js";import{b as h,Q as W,d as Y}from"./QSeparator.8f075170.js";import{Q as B}from"./QBanner.f47124b3.js";import{Q as X}from"./QBadge.d199663e.js";import{u as ee,A as le}from"./ActivityTable.3e01a933.js";import"./QResizeObserver.458e16b0.js";import"./QBtnGroup.74aa5ca1.js";import"./QCheckbox.9418787b.js";const ae=w("br",null,null,-1),te=V({__name:"UserCreateDrawer",setup(N){const e=S(),m=C(),s=x({subject:"",body:""});L(()=>({givenName:e.user.givenName,surname:e.user.surname}),u=>{s.value.subject=`Onboarding ${u.givenName} ${u.surname}`,s.value.body=`Please add ${u.givenName} to the Active Directory.
Name: ${u.givenName}
Surname: ${u.surname}

Thanks

This email has been sent from FileMaker by ${m.loggedUser.fullName}`},{immediate:!0});const c=()=>{e.user={givenName:"",surname:"",status:"Pending",groupId:null}};return(u,r)=>(v(),g(k,{modelValue:a(e).createMode,"onUpdate:modelValue":r[5]||(r[5]=d=>a(e).createMode=d),onBeforeShow:r[6]||(r[6]=d=>c()),width:384,bordered:"",overlay:"",side:"right"},{default:t(()=>[l(y,null,{default:t(()=>[l(p,null,{default:t(()=>[l(I,null,{default:t(()=>[i(" Create User ")]),_:1}),l(U,{class:"text-body2"},{default:t(()=>[i(" A new User will be created and, an email request to add him/her to Active Directory will be send ")]),_:1}),ae,l($,{dense:"",label:"Create User and Send Request",icon:"person_add",color:"primary",onClick:r[0]||(r[0]=d=>a(e).createUser(s.value)),disable:!a(e).user.givenName||!a(e).user.surname},null,8,["disable"])]),_:1}),l(p,null,{default:t(()=>[l(f,{modelValue:a(e).user.givenName,"onUpdate:modelValue":r[1]||(r[1]=d=>a(e).user.givenName=d),label:"Name",rules:[d=>!!d||"Name is required"]},null,8,["modelValue","rules"]),l(f,{modelValue:a(e).user.surname,"onUpdate:modelValue":r[2]||(r[2]=d=>a(e).user.surname=d),label:"Surname",rules:[d=>!!d||"Surname is required"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(y,{class:"bg-blue-2"},{default:t(()=>[l(p,null,{default:t(()=>[l(A,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:t(()=>[l(_,{avatar:""},{default:t(()=>[l(Q,{name:"mail"})]),_:1}),l(_,null,{default:t(()=>[i(b(a(m).contactData),1)]),_:1})]),_:1}),l(f,{modelValue:s.value.subject,"onUpdate:modelValue":r[3]||(r[3]=d=>s.value.subject=d),label:"Subject"},null,8,["modelValue"]),l(f,{modelValue:s.value.body,"onUpdate:modelValue":r[4]||(r[4]=d=>s.value.body=d),label:"Body",type:"textarea",autogrow:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),se=V({__name:"UserUpdateDrawer",setup(N){const e=S(),m=C(),s=x({subject:"",body:""}),c=x(320),u=()=>{e.user=JSON.parse(JSON.stringify(e.selectedUser))},r=()=>{if(e.selectedUser.status!=="Inactive"&&e.user.status==="Inactive"){e.user.groupId=null;const d=e.user.email;e.user.email=null,c.value=720,s.value.subject=`Deauthorize ${e.user.givenName} ${e.user.surname}`,s.value.body=`Please remove ${e.user.givenName} from the Active Directory.
Name: ${e.user.givenName}
Surname: ${e.user.surname}
Email: ${d}
 
Thanks
 
This email has been sent from FileMaker by ${m.loggedUser.fullName}`}else c.value=320};return(d,o)=>(v(),g(k,{modelValue:a(e).editMode,"onUpdate:modelValue":o[11]||(o[11]=n=>a(e).editMode=n),onBeforeShow:o[12]||(o[12]=n=>u()),onBeforeHide:o[13]||(o[13]=n=>c.value=320),width:c.value,bordered:"",overlay:"",side:"right",class:"row"},{default:t(()=>[l(y,{class:"col"},{default:t(()=>[l(p,{horizontal:""},{default:t(()=>[l(I,null,{default:t(()=>[i(" Edit User ")]),_:1}),l($,{dense:"",label:"Save Changes",icon:"save",color:"primary",onClick:o[0]||(o[0]=n=>a(e).updateUser(s.value)),disable:a(e).user.status==="Active"&&!a(e).user.groupId},null,8,["disable"])]),_:1}),l(p,null,{default:t(()=>[l(f,{modelValue:a(e).user.givenName,"onUpdate:modelValue":o[1]||(o[1]=n=>a(e).user.givenName=n),label:"Name"},null,8,["modelValue"]),l(f,{modelValue:a(e).user.surname,"onUpdate:modelValue":o[2]||(o[2]=n=>a(e).user.surname=n),label:"Surname"},null,8,["modelValue"]),l(f,{modelValue:a(e).user.loginName,"onUpdate:modelValue":o[3]||(o[3]=n=>a(e).user.loginName=n),label:"Login"},null,8,["modelValue"]),l(f,{modelValue:a(e).user.email,"onUpdate:modelValue":o[4]||(o[4]=n=>a(e).user.email=n),label:"Email",type:"email",rules:[n=>!n||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(n)||"Invalid email"]},null,8,["modelValue","rules"]),l(f,{modelValue:a(e).user.note,"onUpdate:modelValue":o[5]||(o[5]=n=>a(e).user.note=n),label:"Note",type:"textarea"},null,8,["modelValue"])]),_:1}),l(p,{style:{"background-color":"rgb(197, 198, 198)","border-radius":"4%"}},{default:t(()=>[l(h,{modelValue:a(e).user.status,"onUpdate:modelValue":[o[6]||(o[6]=n=>a(e).user.status=n),o[7]||(o[7]=n=>r())],label:"Status",options:a(e).statusOptions},null,8,["modelValue","options"]),l(h,{modelValue:a(e).user.groupId,"onUpdate:modelValue":o[8]||(o[8]=n=>a(e).user.groupId=n),"emit-value":"","map-options":"",label:"Group",clearable:"",disable:a(e).user.status!=="Active",options:a(m).groupsOptions},null,8,["modelValue","disable","options"])]),_:1}),a(e).user.status==="Active"&&(a(e).user.groupId===null||a(e).user.groupId==="")?(v(),g(p,{key:0},{default:t(()=>[l(B,{class:"bg-orange text-white",rounded:""},{avatar:t(()=>[l(Q,{name:"warning"})]),default:t(()=>[i(" Select a Group before saving changes ")]),_:1})]),_:1})):T("",!0)]),_:1}),a(e).selectedUser.status!=="Inactive"&&a(e).user.status==="Inactive"?(v(),g(y,{key:0,class:"col"},{default:t(()=>[l(p,null,{default:t(()=>[l(B,{class:"bg-red text-white",rounded:""},{avatar:t(()=>[l(Q,{name:"warning"})]),default:t(()=>[i(" You are going to inactivate this user, the email and the group associated will be removed and an email to unauthorized the user will be sent. ")]),_:1})]),_:1}),l(y,{class:"bg-blue-2"},{default:t(()=>[l(p,null,{default:t(()=>[l(A,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:t(()=>[l(_,{avatar:""},{default:t(()=>[l(Q,{name:"mail"})]),_:1}),l(_,null,{default:t(()=>[i(b(a(m).contactData),1)]),_:1})]),_:1}),l(f,{modelValue:s.value.subject,"onUpdate:modelValue":o[9]||(o[9]=n=>s.value.subject=n),label:"Subject"},null,8,["modelValue"]),l(f,{modelValue:s.value.body,"onUpdate:modelValue":o[10]||(o[10]=n=>s.value.body=n),label:"Body",type:"textarea",autogrow:"",hint:"The email can be personalized before sending it."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):T("",!0)]),_:1},8,["modelValue","width"]))}});const re=V({__name:"UsersList",setup(N){const e=S(),m=q(),s=c=>{e.selectedUser=c,e.editMode=!1,e.createMode=!1,m.readActivity(ee.value)};return(c,u)=>(v(),g(y,{style:{width:"100%"}},{default:t(()=>[l(K,{style:{"margin-top":"76px"}},{default:t(()=>[(v(!0),z(D,null,E(a(e).filterUsers,r=>(v(),g(A,{key:r.userId,clickable:"",onClick:d=>s(r),class:"bg-grey-2 menu",active:a(e).selectedUser===r,"active-class":"menu-active"},{default:t(()=>[l(_,{avatar:""},{default:t(()=>[l(j,{style:P({backgroundColor:r.color}),class:"text-white"},{default:t(()=>[i(b(r.initials),1)]),_:2},1032,["style"])]),_:2},1024),l(_,null,{default:t(()=>[l(U,{class:"text-h4"},{default:t(()=>[i(b(r.givenName),1)]),_:2},1024),l(U,{class:"text-h5"},{default:t(()=>[i(b(r.surname),1)]),_:2},1024)]),_:2},1024),l(_,{side:"",top:""},{default:t(()=>[l(X,{rounded:"",color:r.status==="Active"?"green":r.status==="Pending"?"orange":"grey"},null,8,["color"])]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:1})]),_:1}))}});var oe=O(re,[["__scopeId","data-v-d8b8b4e8"]]);const ue=V({__name:"UserAvatar",setup(N){const e=S();return(m,s)=>(v(),g(j,G({style:{backgroundColor:a(e).selectedUser.color},class:"text-white"},m.$attrs),{default:t(()=>[i(b(a(e).selectedUser.initials),1)]),_:1},16,["style"]))}}),ne=V({__name:"UserInfoCard",setup(N){const e=S(),m=C();return(s,c)=>(v(),g(y,{style:{width:"16rem"}},{default:t(()=>[l(p,{class:"row"},{default:t(()=>[l(W),l(Y,{dark:"",size:"md",label:a(e).selectedUser.status,color:a(e).selectedUser.status==="Active"?"green":a(e).selectedUser.status==="Pending"?"orange":"grey"},null,8,["label","color"])]),_:1}),l(p,{class:"column items-center q-pa-none"},{default:t(()=>[l(ue,{size:"100px"})]),_:1}),l(p,null,{default:t(()=>[l(U,{class:"text-h3 text-center"},{default:t(()=>{var u;return[i(b((u=a(e).selectedUser)==null?void 0:u.givenName),1)]}),_:1}),l(U,{class:"text-h4 text-center"},{default:t(()=>{var u;return[i(b((u=a(e).selectedUser)==null?void 0:u.surname),1)]}),_:1})]),_:1}),l(p,{class:"bg-blue-2"},{default:t(()=>[l(_,{avatar:""},{default:t(()=>[l(U,null,{default:t(()=>[i("Group")]),_:1}),l(U,{class:"text-h4"},{default:t(()=>[i(b(a(e).selectedUser.groupId?a(m).groups[a(e).selectedUser.groupId].name:"No Group"),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),de=V({__name:"UsersSearch",setup(N){const e=S();return(m,s)=>(v(),g(f,{modelValue:a(e).searchTerm,"onUpdate:modelValue":s[1]||(s[1]=c=>a(e).searchTerm=c),type:"search",placeholder:"Search\u2026",filled:""},{append:t(()=>[l(Q,{name:a(e).searchTerm?"close":"search",class:F({"cursor-pointer":a(e).searchTerm}),onClick:s[0]||(s[0]=c=>a(e).searchTerm?a(e).searchTerm="":null)},null,8,["name","class"])]),_:1},8,["modelValue"]))}}),ie={class:"row items-start"},me={style:{width:"300px"}},ce={class:"col"},xe=V({__name:"UsersPage",setup(N){const e=S(),m=C(),s=x(!0);return R(()=>{m.readSettings(),e.readAllUsers()}),(c,u)=>(v(),z(D,null,[l(te),l(se),l(k,{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=r=>s.value=r),side:"left",width:320,class:"row"},{default:t(()=>[l(M,{class:"q-pa-md",style:P({backgroundColor:"var(--primary-light)"})},{default:t(()=>[l(de)]),_:1},8,["style"]),l(oe)]),_:1},8,["modelValue"]),l(J,{class:"row-container"},{default:t(()=>[l(M,null,{default:t(()=>[l(Z,null,{default:t(()=>[s.value?(v(),g($,{key:1,onClick:u[2]||(u[2]=r=>s.value=!s.value),icon:"menu"})):(v(),g($,{key:0,onClick:u[1]||(u[1]=r=>s.value=!s.value),icon:"menu"})),l(I,null,{default:t(()=>[i("Users \xBB "+b(a(e).selectedUser.givenName)+" "+b(a(e).selectedUser.surname),1)]),_:1}),l(H,null,{default:t(()=>[l($,{icon:a(e).createMode?"close":"add",label:a(e).createMode?"Cancel Create":"Create User",onClick:u[3]||(u[3]=r=>{(a(e).createMode=!a(e).createMode)&&(a(e).editMode=!1)})},null,8,["icon","label"]),l($,{icon:a(e).editMode?"close":"edit",label:a(e).editMode?"Cancel Edit":"Edit User",onClick:u[4]||(u[4]=r=>{(a(e).editMode=!a(e).editMode)&&(a(e).createMode=!1)})},null,8,["icon","label"])]),_:1})]),_:1})]),_:1}),w("div",ie,[w("div",me,[l(ne)]),w("div",ce,[l(le,{showSelections:!1})])])]),_:1})],64))}});export{xe as default};
