import{x as L,y as X,z as B,R as k,S as Y,B as s,H as N,J,X as G,C as F,E as T,F as Z,al as ee,ae as U,ag as te,ar as le,ak as ne}from"./index.481c2d9a.js";import{b as ae}from"./QLayout.03322efe.js";import{Q as ie}from"./QChip.37129d69.js";import{u as ue,c as re,e as oe,h as se,f as $,d as ce}from"./QInput.62713b3e.js";import{c as fe,d as de}from"./use-form.aee44101.js";import{k as ve}from"./QSelect.0f167acb.js";var ze=L({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:d,emit:S}){const{proxy:{$q:h}}=T(),t=X(Z,B);if(t===B)return console.error("QFooter needs to be child of QLayout"),B;const o=k(parseInt(e.heightHint,10)),f=k(!0),p=k(Y.value===!0||t.isContainer.value===!0?0:window.innerHeight),x=s(()=>e.reveal===!0||t.view.value.indexOf("F")>-1||h.platform.is.ios&&t.isContainer.value===!0),V=s(()=>t.isContainer.value===!0?t.containerHeight.value:p.value),_=s(()=>{if(e.modelValue!==!0)return 0;if(x.value===!0)return f.value===!0?o.value:0;const a=t.scroll.value.position+V.value+o.value-t.height.value;return a>0?a:0}),j=s(()=>e.modelValue!==!0||x.value===!0&&f.value!==!0),q=s(()=>e.modelValue===!0&&j.value===!0&&e.reveal===!0),w=s(()=>"q-footer q-layout__section--marginal "+(x.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+(j.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(x.value!==!0?" hidden":""):"")),O=s(()=>{const a=t.rows.value.bottom,n={};return a[0]==="l"&&t.left.space===!0&&(n[h.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),a[2]==="r"&&t.right.space===!0&&(n[h.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),n});function u(a,n){t.update("footer",a,n)}function b(a,n){a.value!==n&&(a.value=n)}function A({height:a}){b(o,a),u("size",a)}function l(){if(e.reveal!==!0)return;const{direction:a,position:n,inflectionPoint:v}=t.scroll.value;b(f,a==="up"||n-v<100||t.height.value-V.value-n-o.value<300)}function m(a){q.value===!0&&b(f,!0),S("focusin",a)}N(()=>e.modelValue,a=>{u("space",a),b(f,!0),t.animate()}),N(_,a=>{u("offset",a)}),N(()=>e.reveal,a=>{a===!1&&b(f,e.modelValue)}),N(f,a=>{t.animate(),S("reveal",a)}),N([o,t.scroll,t.height],l),N(()=>h.screen.height,a=>{t.isContainer.value!==!0&&b(p,a)});const z={};return t.instances.footer=z,e.modelValue===!0&&u("size",o.value),u("space",e.modelValue),u("offset",_.value),J(()=>{t.instances.footer===z&&(t.instances.footer=void 0,u("size",0),u("offset",0),u("space",!1))}),()=>{const a=G(d.default,[F(ae,{debounce:0,onResize:A})]);return e.elevated===!0&&a.push(F("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),F("footer",{class:w.value,style:O.value,onFocusin:m},a)}}});function P(e,d,S,h){const t=[];return e.forEach(o=>{h(o)===!0?t.push(o):d.push({failedPropValidation:S,file:o})}),t}function I(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),U(e)}const me={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},ge=["rejected"];function he({editable:e,dnd:d,getFileInput:S,addFilesToQueue:h}){const{props:t,emit:o,proxy:f}=T(),p=k(null),x=s(()=>t.accept!==void 0?t.accept.split(",").map(l=>(l=l.trim(),l==="*"?"*/":(l.endsWith("/*")&&(l=l.slice(0,l.length-1)),l.toUpperCase()))):null),V=s(()=>parseInt(t.maxFiles,10)),_=s(()=>parseInt(t.maxTotalSize,10));function j(l){if(e.value)if(l!==Object(l)&&(l={target:null}),l.target!==null&&l.target.matches('input[type="file"]')===!0)l.clientX===0&&l.clientY===0&&ee(l);else{const m=S();m&&m!==l.target&&m.click(l)}}function q(l){e.value&&l&&h(null,l)}function w(l,m,z,a){let n=Array.from(m||l.target.files);const v=[],C=()=>{v.length!==0&&o("rejected",v)};if(t.accept!==void 0&&x.value.indexOf("*/")===-1&&(n=P(n,v,"accept",r=>x.value.some(c=>r.type.toUpperCase().startsWith(c)||r.name.toUpperCase().endsWith(c))),n.length===0))return C();if(t.maxFileSize!==void 0){const r=parseInt(t.maxFileSize,10);if(n=P(n,v,"max-file-size",c=>c.size<=r),n.length===0)return C()}if(t.multiple!==!0&&n.length!==0&&(n=[n[0]]),n.forEach(r=>{r.__key=r.webkitRelativePath+r.lastModified+r.name+r.size}),a===!0){const r=z.map(c=>c.__key);n=P(n,v,"duplicate",c=>r.includes(c.__key)===!1)}if(n.length===0)return C();if(t.maxTotalSize!==void 0){let r=a===!0?z.reduce((c,R)=>c+R.size,0):0;if(n=P(n,v,"max-total-size",c=>(r+=c.size,r<=_.value)),n.length===0)return C()}if(typeof t.filter=="function"){const r=t.filter(n);n=P(n,v,"filter",c=>r.includes(c))}if(t.maxFiles!==void 0){let r=a===!0?z.length:0;if(n=P(n,v,"max-files",()=>(r++,r<=V.value)),n.length===0)return C()}if(C(),n.length!==0)return n}function O(l){I(l),d.value!==!0&&(d.value=!0)}function u(l){U(l),(l.relatedTarget!==null||te.is.safari!==!0?l.relatedTarget!==p.value:document.elementsFromPoint(l.clientX,l.clientY).includes(p.value)===!1)===!0&&(d.value=!1)}function b(l){I(l);const m=l.dataTransfer.files;m.length!==0&&h(null,m),d.value=!1}function A(l){if(d.value===!0)return F("div",{ref:p,class:`q-${l}__dnd absolute-full`,onDragenter:I,onDragover:I,onDragleave:u,onDrop:b})}return Object.assign(f,{pickFiles:j,addFiles:q}),{pickFiles:j,addFiles:q,onDragover:O,onDragleave:u,processFiles:w,getDndNode:A,maxFilesNumber:V,maxTotalSizeNumber:_}}var Ce=L({name:"QFile",inheritAttrs:!1,props:{...ue,...fe,...me,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...re,...ge],setup(e,{slots:d,emit:S,attrs:h}){const{proxy:t}=T(),o=oe(),f=k(null),p=k(!1),x=de(e),{pickFiles:V,onDragover:_,onDragleave:j,processFiles:q,getDndNode:w}=he({editable:o.editable,dnd:p,getFileInput:E,addFilesToQueue:H}),O=se(e),u=s(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),b=s(()=>$(u.value)),A=s(()=>u.value.map(i=>i.name).join(", ")),l=s(()=>ve(u.value.reduce((i,g)=>i+g.size,0))),m=s(()=>({totalSize:l.value,filesNumber:u.value.length,maxFiles:e.maxFiles})),z=s(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:x.value,...h,id:o.targetUid.value,disabled:o.editable.value!==!0})),a=s(()=>"q-file q-field--auto-height"+(p.value===!0?" q-file--dnd":"")),n=s(()=>e.multiple===!0&&e.append===!0);function v(i){const g=u.value.slice();g.splice(i,1),r(g)}function C(i){const g=u.value.indexOf(i);g>-1&&v(g)}function r(i){S("update:modelValue",e.multiple===!0?i:i[0])}function c(i){i.keyCode===13&&ne(i)}function R(i){(i.keyCode===13||i.keyCode===32)&&V(i)}function E(){return f.value}function H(i,g){const y=q(i,g,u.value,n.value),Q=E();Q!=null&&(Q.value=""),y!==void 0&&((e.multiple===!0?e.modelValue&&y.every(W=>u.value.includes(W)):e.modelValue===y[0])||r(n.value===!0?u.value.concat(y):y))}function D(){return[F("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function K(){if(d.file!==void 0)return u.value.length===0?D():u.value.map((g,y)=>d.file({index:y,file:g,ref:this}));if(d.selected!==void 0)return u.value.length===0?D():d.selected({files:u.value,ref:this});if(e.useChips===!0)return u.value.length===0?D():u.value.map((g,y)=>F(ie,{key:"file-"+y,removable:o.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{v(y)}},()=>F("span",{class:"ellipsis",textContent:g.name})));const i=e.displayValue!==void 0?e.displayValue:A.value;return i.length!==0?[F("div",{class:e.inputClass,style:e.inputStyle,textContent:i})]:D()}function M(){const i={ref:f,...z.value,...O.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:H};return e.multiple===!0&&(i.multiple=!0),F("input",i)}return Object.assign(o,{fieldClass:a,emitValue:r,hasValue:b,inputRef:f,innerValue:u,floatingLabel:s(()=>b.value===!0||$(e.displayValue)),computedCounter:s(()=>{if(e.counterLabel!==void 0)return e.counterLabel(m.value);const i=e.maxFiles;return`${u.value.length}${i!==void 0?" / "+i:""} (${l.value})`}),getControlChild:()=>w("file"),getControl:()=>{const i={ref:o.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return o.editable.value===!0&&Object.assign(i,{onDragover:_,onDragleave:j,onKeydown:c,onKeyup:R}),F("div",i,[M()].concat(K()))}}),Object.assign(t,{removeAtIndex:v,removeFile:C,getNativeElement:()=>f.value}),le(t,"nativeEl",()=>f.value),ce(o)}});export{Ce as Q,ze as a};
