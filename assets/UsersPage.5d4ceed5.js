import{Q as I}from"./QDrawer.c7e11fe7.js";import{Q as z}from"./QPage.5fe767ee.js";import{i as U,a as y,u as w,O as N,F as P,o as p,k as g,w as t,m as l,l as a,p as m,Q as x,a9 as $,t as f,a5 as k,aT as C,X as h,a1 as L,n as D,aU as q,a2 as E,_ as j,aV as O,aW as F,$ as G}from"./index.18e7b13f.js";import{Q as M}from"./QToolbarTitle.66ac37f5.js";import{a as _,b as S,Q}from"./use-form.2e4f209f.js";import{Q as v}from"./QInput.6855e887.js";import{Q as T,a as b}from"./QItem.e97e7b2d.js";import{Q as A}from"./QSelect.a339a826.js";import{Q as B}from"./QBanner.78f00b27.js";import{Q as Z}from"./QBadge.12868d6d.js";import{Q as J}from"./QList.77eebc8e.js";import{Q as W}from"./QSpace.01a593f3.js";import{Q as H}from"./QChip.a51c313e.js";import{Q as R}from"./QCardActions.e2d4ce61.js";import{Q as X}from"./QToolbar.b96e205f.js";import"./touch.3df10340.js";const Y=k("br",null,null,-1),K=U({__name:"UserCreateDrawer",setup(V){const e=y(),n=w(),s=N({subject:"",body:""});P(()=>({givenName:e.user.givenName,surname:e.user.surname}),o=>{s.value.subject=`Onboarding ${o.givenName} ${o.surname}`,s.value.body=`Please add ${o.givenName} to the Active Directory.
Name: ${o.givenName}
Surname: ${o.surname}

Thanks

This email has been sent from FileMaker by ${n.loggedUser.fullName}`},{immediate:!0});const c=()=>{e.user={givenName:"",surname:"",status:"Pending",groupId:null}};return(o,d)=>(p(),g(I,{modelValue:l(e).createMode,"onUpdate:modelValue":d[5]||(d[5]=i=>l(e).createMode=i),onBeforeShow:d[6]||(d[6]=i=>c()),width:384,bordered:"",overlay:"",side:"right"},{default:t(()=>[a(Q,null,{default:t(()=>[a(_,null,{default:t(()=>[a(M,null,{default:t(()=>[m(" Create User ")]),_:1}),a(S,{class:"text-body2"},{default:t(()=>[m(" A new User will be created and, an email request to add him/her to Active Directory will be send ")]),_:1}),Y,a(x,{dense:"",label:"Create User and Send Request",icon:"sym_o_person_add",color:"primary",onClick:d[0]||(d[0]=i=>l(e).createUser(s.value)),disable:!l(e).user.givenName||!l(e).user.surname},null,8,["disable"])]),_:1}),a(_,null,{default:t(()=>[a(v,{modelValue:l(e).user.givenName,"onUpdate:modelValue":d[1]||(d[1]=i=>l(e).user.givenName=i),label:"Name",rules:[i=>!!i||"Name is required"]},null,8,["modelValue","rules"]),a(v,{modelValue:l(e).user.surname,"onUpdate:modelValue":d[2]||(d[2]=i=>l(e).user.surname=i),label:"Surname",rules:[i=>!!i||"Surname is required"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),a(Q,{class:"bg-blue-2"},{default:t(()=>[a(_,null,{default:t(()=>[a(T,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[a($,{name:"sym_o_mail"})]),_:1}),a(b,null,{default:t(()=>[m(f(l(n).contactData.toEmail)+", "+f(l(n).contactData.ccEmail),1)]),_:1})]),_:1}),a(v,{modelValue:s.value.subject,"onUpdate:modelValue":d[3]||(d[3]=i=>s.value.subject=i),label:"Subject"},null,8,["modelValue"]),a(v,{modelValue:s.value.body,"onUpdate:modelValue":d[4]||(d[4]=i=>s.value.body=i),label:"Body",type:"textarea",autogrow:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ee={key:0},ae=U({__name:"UserUpdateDrawer",setup(V){const e=y(),n=w(),s=N({subject:"",body:""}),c=N(320),o=()=>{e.user=JSON.parse(JSON.stringify(e.selectedUser))},d=()=>{if(e.selectedUser.status!=="Inactive"&&e.user.status==="Inactive"){e.user.groupId=null;const i=e.user.email;e.user.email=null,c.value=720,s.value.subject=`Deauthorize ${e.user.givenName} ${e.user.surname}`,s.value.body=`Please remove ${e.user.givenName} from the Active Directory.
Name: ${e.user.givenName}
Surname: ${e.user.surname}
Email: ${i}
 
Thanks
 
This email has been sent from FileMaker by ${n.loggedUser.fullName}`}else c.value=320};return(i,r)=>(p(),g(I,{modelValue:l(e).editMode,"onUpdate:modelValue":r[11]||(r[11]=u=>l(e).editMode=u),onBeforeShow:r[12]||(r[12]=u=>o()),onBeforeHide:r[13]||(r[13]=u=>c.value=320),width:c.value,bordered:"",overlay:"",side:"right",class:"row"},{default:t(()=>[a(Q,{class:"col"},{default:t(()=>[a(_,{horizontal:""},{default:t(()=>[a(M,null,{default:t(()=>[m(" Edit User ")]),_:1}),a(x,{dense:"",label:"Save Changes",icon:"sym_o_save",color:"primary",onClick:r[0]||(r[0]=u=>l(e).updateUser(s.value)),disable:l(e).user.status==="Active"&&!l(e).user.groupId},null,8,["disable"])]),_:1}),a(_,null,{default:t(()=>[a(v,{modelValue:l(e).user.givenName,"onUpdate:modelValue":r[1]||(r[1]=u=>l(e).user.givenName=u),label:"Name"},null,8,["modelValue"]),a(v,{modelValue:l(e).user.surname,"onUpdate:modelValue":r[2]||(r[2]=u=>l(e).user.surname=u),label:"Surname"},null,8,["modelValue"]),a(v,{modelValue:l(e).user.loginName,"onUpdate:modelValue":r[3]||(r[3]=u=>l(e).user.loginName=u),label:"Login"},null,8,["modelValue"]),a(v,{modelValue:l(e).user.email,"onUpdate:modelValue":r[4]||(r[4]=u=>l(e).user.email=u),label:"Email",type:"email",rules:[u=>!u||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(u)||"Invalid email"]},null,8,["modelValue","rules"]),a(v,{modelValue:l(e).user.note,"onUpdate:modelValue":r[5]||(r[5]=u=>l(e).user.note=u),label:"Note",type:"textarea"},null,8,["modelValue"])]),_:1}),a(_,{style:{"background-color":"rgb(197, 198, 198)","border-radius":"4%"}},{default:t(()=>[a(A,{modelValue:l(e).user.status,"onUpdate:modelValue":[r[6]||(r[6]=u=>l(e).user.status=u),r[7]||(r[7]=u=>d())],label:"Status",options:l(e).statusOptions},null,8,["modelValue","options"]),a(A,{modelValue:l(e).user.groupId,"onUpdate:modelValue":r[8]||(r[8]=u=>l(e).user.groupId=u),"emit-value":"","map-options":"",label:"Group",clearable:"",options:l(n).groupsOptions,disable:l(e).user.status!=="Active"},null,8,["modelValue","options","disable"])]),_:1}),l(e).user.status==="Active"&&(l(e).user.groupId===null||l(e).user.groupId==="")?(p(),g(_,{key:0},{default:t(()=>[a(B,{class:"bg-orange text-white",rounded:""},{avatar:t(()=>[a($,{name:"sym_o_warning"})]),default:t(()=>[m(" Select a Group before saving changes ")]),_:1})]),_:1})):C("",!0)]),_:1}),l(e).selectedUser.status!=="Inactive"&&l(e).user.status==="Inactive"?(p(),g(Q,{key:0,class:"col"},{default:t(()=>[a(_,null,{default:t(()=>[a(B,{class:"bg-red text-white",rounded:""},{avatar:t(()=>[a($,{name:"sym_o_warning"})]),default:t(()=>[m(" You are going to inactivate this user, the email and the group associated will be removed and an email to unauthorized the user will be sent. ")]),_:1})]),_:1}),a(Q,{class:"bg-blue-2"},{default:t(()=>[a(_,null,{default:t(()=>[a(T,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[a($,{name:"sym_o_mail"})]),_:1}),a(b,null,{default:t(()=>[m(f(l(n).contactData.toEmail)+" ",1),l(n).contactData.ccEmail?(p(),h("span",ee,", "+f(l(n).contactData.ccEmail),1)):C("",!0)]),_:1})]),_:1}),a(v,{modelValue:s.value.subject,"onUpdate:modelValue":r[9]||(r[9]=u=>s.value.subject=u),label:"Subject"},null,8,["modelValue"]),a(v,{modelValue:s.value.body,"onUpdate:modelValue":r[10]||(r[10]=u=>s.value.body=u),label:"Body",type:"textarea",autogrow:"",hint:"The email can be personalized before sending it."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):C("",!0)]),_:1},8,["modelValue","width"]))}});const le=U({__name:"UsersList",setup(V){const e=y(),n=s=>{e.selectedUser=s,e.editMode=!1,e.createMode=!1};return(s,c)=>(p(),g(Q,{style:{width:"100%"}},{default:t(()=>[a(J,null,{default:t(()=>[(p(!0),h(E,null,L(l(e).filterUsers,o=>(p(),g(T,{key:o.userId,clickable:"",onClick:d=>n(o),class:"bg-grey-2 menu",active:l(e).selectedUser===o,"active-class":"menu-active"},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[a(D,{style:q({backgroundColor:o.color}),class:"text-white"},{default:t(()=>[m(f(o.initials),1)]),_:2},1032,["style"])]),_:2},1024),a(b,null,{default:t(()=>[a(S,{class:"text-h4"},{default:t(()=>[m(f(o.givenName),1)]),_:2},1024),a(S,{class:"text-h5"},{default:t(()=>[m(f(o.surname),1)]),_:2},1024)]),_:2},1024),a(b,{side:"",top:""},{default:t(()=>[a(Z,{rounded:"",color:o.status==="Active"?"green":o.status==="Pending"?"orange":"grey"},null,8,["color"])]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:1})]),_:1}))}});var te=j(le,[["__scopeId","data-v-3087e394"]]);const se=U({__name:"UserAvatar",setup(V){const e=y();return(n,s)=>(p(),g(D,O({style:{backgroundColor:l(e).selectedUser.color},class:"text-white"},n.$attrs),{default:t(()=>[m(f(l(e).selectedUser.initials),1)]),_:1},16,["style"]))}}),re=U({__name:"UserInfoCard",setup(V){const e=y(),n=w();return(s,c)=>(p(),g(Q,{style:{width:"16rem"}},{default:t(()=>[a(_,{class:"row"},{default:t(()=>[a(W),a(H,{dark:"",size:"md",label:l(e).selectedUser.status,color:l(e).selectedUser.status==="Active"?"green":l(e).selectedUser.status==="Pending"?"orange":"grey"},null,8,["label","color"])]),_:1}),a(_,{class:"column items-center q-pa-none"},{default:t(()=>[a(se,{size:"100px"})]),_:1}),a(_,null,{default:t(()=>[a(S,{class:"text-h3 text-center"},{default:t(()=>{var o;return[m(f((o=l(e).selectedUser)==null?void 0:o.givenName),1)]}),_:1}),a(S,{class:"text-h4 text-center"},{default:t(()=>{var o;return[m(f((o=l(e).selectedUser)==null?void 0:o.surname),1)]}),_:1})]),_:1}),a(_,{class:"bg-blue-2"},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[a(S,null,{default:t(()=>[m("Group")]),_:1}),a(S,{class:"text-h4"},{default:t(()=>[m(f(l(e).selectedUser.groupId?l(n).groups[l(e).selectedUser.groupId].name:"No Group"),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),oe=U({__name:"UsersSearch",setup(V){const e=y();return(n,s)=>(p(),g(v,{modelValue:l(e).searchTerm,"onUpdate:modelValue":s[1]||(s[1]=c=>l(e).searchTerm=c),type:"search",placeholder:"Search\u2026",filled:""},{append:t(()=>[a($,{name:l(e).searchTerm?"sym_o_close":"sym_o_search",class:F({"cursor-pointer":l(e).searchTerm}),onClick:s[0]||(s[0]=c=>l(e).searchTerm?l(e).searchTerm="":null)},null,8,["name","class"])]),_:1},8,["modelValue"]))}}),ue=U({__name:"UsersToolbar",setup(V){const e=y();return(n,s)=>(p(),g(X,null,{default:t(()=>[a(M,null,{default:t(()=>[m("Users \xBB "+f(l(e).selectedUser.givenName)+" "+f(l(e).selectedUser.surname),1)]),_:1}),a(R,null,{default:t(()=>[a(x,{icon:l(e).createMode?"sym_o_close":"sym_o_add",label:l(e).createMode?"Cancel Create":"Create User",onClick:s[0]||(s[0]=c=>{(l(e).createMode=!l(e).createMode)&&(l(e).editMode=!1)})},null,8,["icon","label"]),a(x,{icon:l(e).editMode?"sym_o_close":"sym_o_edit",label:l(e).editMode?"Cancel Edit":"Edit User",onClick:s[1]||(s[1]=c=>{(l(e).editMode=!l(e).editMode)&&(l(e).createMode=!1)})},null,8,["icon","label"])]),_:1})]),_:1}))}});const ne={class:"fixed-search"},de={class:"row items-center justify-evenly q-pt-xl"},ie=U({__name:"UsersPage",setup(V){const e=y(),n=w(),s=N(!0);return G(()=>{e.users.length||e.readAllUsers(),n.toolbar=ue}),(c,o)=>(p(),h(E,null,[a(K),a(ae),a(I,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=d=>s.value=d),side:"left",width:320},{default:t(()=>[k("div",ne,[a(oe)]),a(te)]),_:1},8,["modelValue"]),a(z,{class:"row-container"},{default:t(()=>[k("div",de,[a(re)])]),_:1})],64))}});var we=j(ie,[["__scopeId","data-v-fd5e64f0"]]);export{we as default};
