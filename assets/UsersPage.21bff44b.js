import{Q as k}from"./QDrawer.e8e93ba9.js";import{Q as j}from"./QPage.f8bc35e6.js";import{i as y,a as U,u as C,N as x,F as P,o as v,k as g,w as l,m as t,l as a,p as c,Q as w,a4 as $,t as p,W as N,aQ as A,e as L,g as B,Y as q,Z as D,_ as z,n as E,aR as O,aS as F,aT as G,aU as Z,a6 as J}from"./index.49fc7c04.js";import{Q as I}from"./QToolbarTitle.fd431f3a.js";import{a as _,b as S,Q}from"./focus-manager.0068caea.js";import{Q as f}from"./QInput.152723dc.js";import{a as h,b,Q as R}from"./QList.fd90aac6.js";import{Q as M}from"./QSelect.0a5bf3b8.js";import{Q as T}from"./QBanner.589f1463.js";import{Q as W}from"./QBadge.bca57178.js";import{Q as Y}from"./QSpace.c614c7e4.js";import{Q as H}from"./QChip.0dea64ff.js";import{Q as K}from"./QCardActions.1b383fd5.js";import{Q as X}from"./QToolbar.0e7d31f4.js";import{A as ee}from"./ActivityTable.b7919a62.js";import"./QBtnGroup.34647990.js";import"./ClosePopup.b42ac126.js";import"./QCheckbox.ee7a24b7.js";import"./QSeparator.f68a0bf8.js";const ae=N("br",null,null,-1),te=y({__name:"UserCreateDrawer",setup(V){const e=U(),n=C(),s=x({subject:"",body:""});P(()=>({givenName:e.user.givenName,surname:e.user.surname}),i=>{s.value.subject=`Onboarding ${i.givenName} ${i.surname}`,s.value.body=`Please add ${i.givenName} to the Active Directory.
Name: ${i.givenName}
Surname: ${i.surname}

Thanks

This email has been sent from FileMaker by ${n.loggedUser.fullName}`},{immediate:!0});const m=()=>{e.user={givenName:"",surname:"",status:"Pending",groupId:null}};return(i,r)=>(v(),g(k,{modelValue:t(e).createMode,"onUpdate:modelValue":r[5]||(r[5]=d=>t(e).createMode=d),onBeforeShow:r[6]||(r[6]=d=>m()),width:384,bordered:"",overlay:"",side:"right"},{default:l(()=>[a(Q,null,{default:l(()=>[a(_,null,{default:l(()=>[a(I,null,{default:l(()=>[c(" Create User ")]),_:1}),a(S,{class:"text-body2"},{default:l(()=>[c(" A new User will be created and, an email request to add him/her to Active Directory will be send ")]),_:1}),ae,a(w,{dense:"",label:"Create User and Send Request",icon:"sym_o_person_add",color:"primary",onClick:r[0]||(r[0]=d=>t(e).createUser(s.value)),disable:!t(e).user.givenName||!t(e).user.surname},null,8,["disable"])]),_:1}),a(_,null,{default:l(()=>[a(f,{modelValue:t(e).user.givenName,"onUpdate:modelValue":r[1]||(r[1]=d=>t(e).user.givenName=d),label:"Name",rules:[d=>!!d||"Name is required"]},null,8,["modelValue","rules"]),a(f,{modelValue:t(e).user.surname,"onUpdate:modelValue":r[2]||(r[2]=d=>t(e).user.surname=d),label:"Surname",rules:[d=>!!d||"Surname is required"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),a(Q,{class:"bg-blue-2"},{default:l(()=>[a(_,null,{default:l(()=>[a(h,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:l(()=>[a(b,{avatar:""},{default:l(()=>[a($,{name:"sym_o_mail"})]),_:1}),a(b,null,{default:l(()=>[c(p(t(n).contactData.toEmail)+", "+p(t(n).contactData.ccEmail),1)]),_:1})]),_:1}),a(f,{modelValue:s.value.subject,"onUpdate:modelValue":r[3]||(r[3]=d=>s.value.subject=d),label:"Subject"},null,8,["modelValue"]),a(f,{modelValue:s.value.body,"onUpdate:modelValue":r[4]||(r[4]=d=>s.value.body=d),label:"Body",type:"textarea",autogrow:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),le=y({__name:"UserUpdateDrawer",setup(V){const e=U(),n=C(),s=x({subject:"",body:""}),m=x(320),i=()=>{e.user=JSON.parse(JSON.stringify(e.selectedUser))},r=()=>{if(e.selectedUser.status!=="Inactive"&&e.user.status==="Inactive"){e.user.groupId=null;const d=e.user.email;e.user.email=null,m.value=720,s.value.subject=`Deauthorize ${e.user.givenName} ${e.user.surname}`,s.value.body=`Please remove ${e.user.givenName} from the Active Directory.
Name: ${e.user.givenName}
Surname: ${e.user.surname}
Email: ${d}
 
Thanks
 
This email has been sent from FileMaker by ${n.loggedUser.fullName}`}else m.value=320};return(d,o)=>(v(),g(k,{modelValue:t(e).editMode,"onUpdate:modelValue":o[11]||(o[11]=u=>t(e).editMode=u),onBeforeShow:o[12]||(o[12]=u=>i()),onBeforeHide:o[13]||(o[13]=u=>m.value=320),width:m.value,bordered:"",overlay:"",side:"right",class:"row"},{default:l(()=>[a(Q,{class:"col"},{default:l(()=>[a(_,{horizontal:""},{default:l(()=>[a(I,null,{default:l(()=>[c(" Edit User ")]),_:1}),a(w,{dense:"",label:"Save Changes",icon:"sym_o_save",color:"primary",onClick:o[0]||(o[0]=u=>t(e).updateUser(s.value)),disable:t(e).user.status==="Active"&&!t(e).user.groupId},null,8,["disable"])]),_:1}),a(_,null,{default:l(()=>[a(f,{modelValue:t(e).user.givenName,"onUpdate:modelValue":o[1]||(o[1]=u=>t(e).user.givenName=u),label:"Name"},null,8,["modelValue"]),a(f,{modelValue:t(e).user.surname,"onUpdate:modelValue":o[2]||(o[2]=u=>t(e).user.surname=u),label:"Surname"},null,8,["modelValue"]),a(f,{modelValue:t(e).user.loginName,"onUpdate:modelValue":o[3]||(o[3]=u=>t(e).user.loginName=u),label:"Login"},null,8,["modelValue"]),a(f,{modelValue:t(e).user.email,"onUpdate:modelValue":o[4]||(o[4]=u=>t(e).user.email=u),label:"Email",type:"email",rules:[u=>!u||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(u)||"Invalid email"]},null,8,["modelValue","rules"]),a(f,{modelValue:t(e).user.note,"onUpdate:modelValue":o[5]||(o[5]=u=>t(e).user.note=u),label:"Note",type:"textarea"},null,8,["modelValue"])]),_:1}),a(_,{style:{"background-color":"rgb(197, 198, 198)","border-radius":"4%"}},{default:l(()=>[a(M,{modelValue:t(e).user.status,"onUpdate:modelValue":[o[6]||(o[6]=u=>t(e).user.status=u),o[7]||(o[7]=u=>r())],label:"Status",options:t(e).statusOptions},null,8,["modelValue","options"]),a(M,{modelValue:t(e).user.groupId,"onUpdate:modelValue":o[8]||(o[8]=u=>t(e).user.groupId=u),"emit-value":"","map-options":"",label:"Group",clearable:"",options:t(n).groupsOptions,disable:t(e).user.status!=="Active"},null,8,["modelValue","options","disable"])]),_:1}),t(e).user.status==="Active"&&(t(e).user.groupId===null||t(e).user.groupId==="")?(v(),g(_,{key:0},{default:l(()=>[a(T,{class:"bg-orange text-white",rounded:""},{avatar:l(()=>[a($,{name:"sym_o_warning"})]),default:l(()=>[c(" Select a Group before saving changes ")]),_:1})]),_:1})):A("",!0)]),_:1}),t(e).selectedUser.status!=="Inactive"&&t(e).user.status==="Inactive"?(v(),g(Q,{key:0,class:"col"},{default:l(()=>[a(_,null,{default:l(()=>[a(T,{class:"bg-red text-white",rounded:""},{avatar:l(()=>[a($,{name:"sym_o_warning"})]),default:l(()=>[c(" You are going to inactivate this user, the email and the group associated will be removed and an email to unauthorized the user will be sent. ")]),_:1})]),_:1}),a(Q,{class:"bg-blue-2"},{default:l(()=>[a(_,null,{default:l(()=>[a(h,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:l(()=>[a(b,{avatar:""},{default:l(()=>[a($,{name:"sym_o_mail"})]),_:1}),a(b,null,{default:l(()=>[c(p(t(n).contactData.toEmail)+", "+p(t(n).contactData.ccEmail),1)]),_:1})]),_:1}),a(f,{modelValue:s.value.subject,"onUpdate:modelValue":o[9]||(o[9]=u=>s.value.subject=u),label:"Subject"},null,8,["modelValue"]),a(f,{modelValue:s.value.body,"onUpdate:modelValue":o[10]||(o[10]=u=>s.value.body=u),label:"Body",type:"textarea",autogrow:"",hint:"The email can be personalized before sending it."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):A("",!0)]),_:1},8,["modelValue","width"]))}});const se=y({__name:"UsersList",setup(V){const e=U(),n=L(),s=m=>{e.selectedUser=m,e.editMode=!1,e.createMode=!1,n.readActivity(F.value)};return(m,i)=>(v(),g(Q,{style:{width:"100%"}},{default:l(()=>[a(R,null,{default:l(()=>[(v(!0),B(D,null,q(t(e).filterUsers,r=>(v(),g(h,{key:r.userId,clickable:"",onClick:d=>s(r),class:"bg-grey-2 menu",active:t(e).selectedUser===r,"active-class":"menu-active"},{default:l(()=>[a(b,{avatar:""},{default:l(()=>[a(E,{style:O({backgroundColor:r.color}),class:"text-white"},{default:l(()=>[c(p(r.initials),1)]),_:2},1032,["style"])]),_:2},1024),a(b,null,{default:l(()=>[a(S,{class:"text-h4"},{default:l(()=>[c(p(r.givenName),1)]),_:2},1024),a(S,{class:"text-h5"},{default:l(()=>[c(p(r.surname),1)]),_:2},1024)]),_:2},1024),a(b,{side:"",top:""},{default:l(()=>[a(W,{rounded:"",color:r.status==="Active"?"green":r.status==="Pending"?"orange":"grey"},null,8,["color"])]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:1})]),_:1}))}});var re=z(se,[["__scopeId","data-v-140edce8"]]);const oe=y({__name:"UserAvatar",setup(V){const e=U();return(n,s)=>(v(),g(E,G({style:{backgroundColor:t(e).selectedUser.color},class:"text-white"},n.$attrs),{default:l(()=>[c(p(t(e).selectedUser.initials),1)]),_:1},16,["style"]))}}),ue=y({__name:"UserInfoCard",setup(V){const e=U(),n=C();return(s,m)=>(v(),g(Q,{style:{width:"16rem"}},{default:l(()=>[a(_,{class:"row"},{default:l(()=>[a(Y),a(H,{dark:"",size:"md",label:t(e).selectedUser.status,color:t(e).selectedUser.status==="Active"?"green":t(e).selectedUser.status==="Pending"?"orange":"grey"},null,8,["label","color"])]),_:1}),a(_,{class:"column items-center q-pa-none"},{default:l(()=>[a(oe,{size:"100px"})]),_:1}),a(_,null,{default:l(()=>[a(S,{class:"text-h3 text-center"},{default:l(()=>{var i;return[c(p((i=t(e).selectedUser)==null?void 0:i.givenName),1)]}),_:1}),a(S,{class:"text-h4 text-center"},{default:l(()=>{var i;return[c(p((i=t(e).selectedUser)==null?void 0:i.surname),1)]}),_:1})]),_:1}),a(_,{class:"bg-blue-2"},{default:l(()=>[a(b,{avatar:""},{default:l(()=>[a(S,null,{default:l(()=>[c("Group")]),_:1}),a(S,{class:"text-h4"},{default:l(()=>[c(p(t(e).selectedUser.groupId?t(n).groups[t(e).selectedUser.groupId].name:"No Group"),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),ne=y({__name:"UsersSearch",setup(V){const e=U();return(n,s)=>(v(),g(f,{modelValue:t(e).searchTerm,"onUpdate:modelValue":s[1]||(s[1]=m=>t(e).searchTerm=m),type:"search",placeholder:"Search\u2026",filled:""},{append:l(()=>[a($,{name:t(e).searchTerm?"sym_o_close":"sym_o_search",class:Z({"cursor-pointer":t(e).searchTerm}),onClick:s[0]||(s[0]=m=>t(e).searchTerm?t(e).searchTerm="":null)},null,8,["name","class"])]),_:1},8,["modelValue"]))}}),de=y({__name:"UsersToolbar",setup(V){const e=U();return(n,s)=>(v(),g(X,null,{default:l(()=>[a(I,null,{default:l(()=>[c("Users \xBB "+p(t(e).selectedUser.givenName)+" "+p(t(e).selectedUser.surname),1)]),_:1}),a(K,null,{default:l(()=>[a(w,{icon:t(e).createMode?"sym_o_close":"sym_o_add",label:t(e).createMode?"Cancel Create":"Create User",onClick:s[0]||(s[0]=m=>{(t(e).createMode=!t(e).createMode)&&(t(e).editMode=!1)})},null,8,["icon","label"]),a(w,{icon:t(e).editMode?"sym_o_close":"sym_o_edit",label:t(e).editMode?"Cancel Edit":"Edit User",onClick:s[1]||(s[1]=m=>{(t(e).editMode=!t(e).editMode)&&(t(e).createMode=!1)})},null,8,["icon","label"])]),_:1})]),_:1}))}});const ie={class:"fixed-search"},me={class:"row items-start"},ce={style:{width:"300px"}},_e={class:"col"},pe=y({__name:"UsersPage",setup(V){const e=U(),n=C(),s=x(!0);return J(()=>{n.readSettings(),e.readAllUsers(),n.toolbar=de}),(m,i)=>(v(),B(D,null,[a(te),a(le),a(k,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=r=>s.value=r),side:"left",width:320},{default:l(()=>[N("div",ie,[a(ne)]),a(re)]),_:1},8,["modelValue"]),a(j,{class:"row-container"},{default:l(()=>[N("div",me,[N("div",ce,[a(ue)]),N("div",_e,[a(ee,{showSelections:!1})])])]),_:1})],64))}});var Te=z(pe,[["__scopeId","data-v-0716756d"]]);export{Te as default};
