import{Q as fe}from"./QToolbarTitle.fd431f3a.js";import{Q as me}from"./QToolbar.0e7d31f4.js";import{Q as ve}from"./QHeader.399efda0.js";import{Q as ae,b as H,a as X}from"./focus-manager.0068caea.js";import{Q as Z}from"./QSpace.c614c7e4.js";import{Q as J}from"./QChip.0dea64ff.js";import{a as E,Q as pe,b as ge}from"./QList.fd90aac6.js";import{u as be,d as ye,a as he,c as Fe,e as Re,i as Ve,f as ne,b as _e,Q as T}from"./QInput.152723dc.js";import{s as se,v as qe,x as G,N as U,O as xe,z as p,F as I,H as Se,U as Ce,A as Q,C as ee,D as Qe,ai as we,ab as oe,ad as ze,ao as ke,ah as Ue,_ as Ne,i as Oe,u as Ie,a as Pe,f as De,a6 as je,T as Le,o as A,k as M,w as f,l as s,p as N,W as B,t as P,m as v,g as Te,Y as Ae,Z as Be,n as ue,a4 as $e,Q as ie,bd as He,aR as Ee,$ as Me,a0 as We}from"./index.49fc7c04.js";import{h as Ke,Q as Ye}from"./QSelect.0a5bf3b8.js";import{Q as Xe}from"./QPage.f8bc35e6.js";import{b as Ze,Q as Ge,a as Je}from"./QLayout.20112d17.js";var et=se({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:g,emit:q}){const{proxy:{$q:n}}=ee(),t=qe(Qe,G);if(t===G)return console.error("QFooter needs to be child of QLayout"),G;const d=U(parseInt(e.heightHint,10)),b=U(!0),x=U(xe.value===!0||t.isContainer.value===!0?0:window.innerHeight),h=p(()=>e.reveal===!0||t.view.value.indexOf("F")>-1||n.platform.is.ios&&t.isContainer.value===!0),R=p(()=>t.isContainer.value===!0?t.containerHeight.value:x.value),u=p(()=>{if(e.modelValue!==!0)return 0;if(h.value===!0)return b.value===!0?d.value:0;const i=t.scroll.value.position+R.value+d.value-t.height.value;return i>0?i:0}),o=p(()=>e.modelValue!==!0||h.value===!0&&b.value!==!0),w=p(()=>e.modelValue===!0&&o.value===!0&&e.reveal===!0),O=p(()=>"q-footer q-layout__section--marginal "+(h.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+(o.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(h.value!==!0?" hidden":""):"")),j=p(()=>{const i=t.rows.value.bottom,a={};return i[0]==="l"&&t.left.space===!0&&(a[n.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),i[2]==="r"&&t.right.space===!0&&(a[n.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),a});function c(i,a){t.update("footer",i,a)}function S(i,a){i.value!==a&&(i.value=a)}function L({height:i}){S(d,i),c("size",i)}function l(){if(e.reveal!==!0)return;const{direction:i,position:a,inflectionPoint:F}=t.scroll.value;S(b,i==="up"||a-F<100||t.height.value-R.value-a-d.value<300)}function V(i){w.value===!0&&S(b,!0),q("focusin",i)}I(()=>e.modelValue,i=>{c("space",i),S(b,!0),t.animate()}),I(u,i=>{c("offset",i)}),I(()=>e.reveal,i=>{i===!1&&S(b,e.modelValue)}),I(b,i=>{t.animate(),q("reveal",i)}),I([d,t.scroll,t.height],l),I(()=>n.screen.height,i=>{t.isContainer.value!==!0&&S(x,i)});const z={};return t.instances.footer=z,e.modelValue===!0&&c("size",d.value),c("space",e.modelValue),c("offset",u.value),Se(()=>{t.instances.footer===z&&(t.instances.footer=void 0,c("size",0),c("offset",0),c("space",!1))}),()=>{const i=Ce(g.default,[Q(Ze,{debounce:0,onResize:L})]);return e.elevated===!0&&i.push(Q("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),Q("footer",{class:O.value,style:j.value,onFocusin:V},i)}}});function D(e,g,q,n){const t=[];return e.forEach(d=>{n(d)===!0?t.push(d):g.push({failedPropValidation:q,file:d})}),t}function W(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),oe(e)}const tt={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},lt=["rejected"];function at({editable:e,dnd:g,getFileInput:q,addFilesToQueue:n}){const{props:t,emit:d,proxy:b}=ee(),x=U(null),h=p(()=>t.accept!==void 0?t.accept.split(",").map(l=>(l=l.trim(),l==="*"?"*/":(l.endsWith("/*")&&(l=l.slice(0,l.length-1)),l.toUpperCase()))):null),R=p(()=>parseInt(t.maxFiles,10)),u=p(()=>parseInt(t.maxTotalSize,10));function o(l){if(e.value)if(l!==Object(l)&&(l={target:null}),l.target!==null&&l.target.matches('input[type="file"]')===!0)l.clientX===0&&l.clientY===0&&we(l);else{const V=q();V&&V!==l.target&&V.click(l)}}function w(l){e.value&&l&&n(null,l)}function O(l,V,z,i){let a=Array.from(V||l.target.files);const F=[],k=()=>{F.length!==0&&d("rejected",F)};if(t.accept!==void 0&&h.value.indexOf("*/")===-1&&(a=D(a,F,"accept",m=>h.value.some(y=>m.type.toUpperCase().startsWith(y)||m.name.toUpperCase().endsWith(y))),a.length===0))return k();if(t.maxFileSize!==void 0){const m=parseInt(t.maxFileSize,10);if(a=D(a,F,"max-file-size",y=>y.size<=m),a.length===0)return k()}if(t.multiple!==!0&&a.length!==0&&(a=[a[0]]),a.forEach(m=>{m.__key=m.webkitRelativePath+m.lastModified+m.name+m.size}),i===!0){const m=z.map(y=>y.__key);a=D(a,F,"duplicate",y=>m.includes(y.__key)===!1)}if(a.length===0)return k();if(t.maxTotalSize!==void 0){let m=i===!0?z.reduce((y,K)=>y+K.size,0):0;if(a=D(a,F,"max-total-size",y=>(m+=y.size,m<=u.value)),a.length===0)return k()}if(typeof t.filter=="function"){const m=t.filter(a);a=D(a,F,"filter",y=>m.includes(y))}if(t.maxFiles!==void 0){let m=i===!0?z.length:0;if(a=D(a,F,"max-files",()=>(m++,m<=R.value)),a.length===0)return k()}if(k(),a.length!==0)return a}function j(l){W(l),g.value!==!0&&(g.value=!0)}function c(l){oe(l),(l.relatedTarget!==null||ze.is.safari!==!0?l.relatedTarget!==x.value:document.elementsFromPoint(l.clientX,l.clientY).includes(x.value)===!1)===!0&&(g.value=!1)}function S(l){W(l);const V=l.dataTransfer.files;V.length!==0&&n(null,V),g.value=!1}function L(l){if(g.value===!0)return Q("div",{ref:x,class:`q-${l}__dnd absolute-full`,onDragenter:W,onDragover:W,onDragleave:c,onDrop:S})}return Object.assign(b,{pickFiles:o,addFiles:w}),{pickFiles:o,addFiles:w,onDragover:j,onDragleave:c,processFiles:O,getDndNode:L,maxFilesNumber:R,maxTotalSizeNumber:u}}var nt=se({name:"QFile",inheritAttrs:!1,props:{...be,...ye,...tt,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...he,...lt],setup(e,{slots:g,emit:q,attrs:n}){const{proxy:t}=ee(),d=Fe(),b=U(null),x=U(!1),h=Re(e),{pickFiles:R,onDragover:u,onDragleave:o,processFiles:w,getDndNode:O}=at({editable:d.editable,dnd:x,getFileInput:te,addFilesToQueue:le}),j=Ve(e),c=p(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),S=p(()=>ne(c.value)),L=p(()=>c.value.map(r=>r.name).join(", ")),l=p(()=>Ke(c.value.reduce((r,_)=>r+_.size,0))),V=p(()=>({totalSize:l.value,filesNumber:c.value.length,maxFiles:e.maxFiles})),z=p(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:h.value,...n,id:d.targetUid.value,disabled:d.editable.value!==!0})),i=p(()=>"q-file q-field--auto-height"+(x.value===!0?" q-file--dnd":"")),a=p(()=>e.multiple===!0&&e.append===!0);function F(r){const _=c.value.slice();_.splice(r,1),m(_)}function k(r){const _=c.value.indexOf(r);_>-1&&F(_)}function m(r){q("update:modelValue",e.multiple===!0?r:r[0])}function y(r){r.keyCode===13&&Ue(r)}function K(r){(r.keyCode===13||r.keyCode===32)&&R(r)}function te(){return b.value}function le(r,_){const C=w(r,_,c.value,a.value),Y=te();Y!=null&&(Y.value=""),C!==void 0&&((e.multiple===!0?e.modelValue&&C.every(de=>c.value.includes(de)):e.modelValue===C[0])||m(a.value===!0?c.value.concat(C):C))}function $(){return[Q("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function re(){if(g.file!==void 0)return c.value.length===0?$():c.value.map((_,C)=>g.file({index:C,file:_,ref:this}));if(g.selected!==void 0)return c.value.length===0?$():g.selected({files:c.value,ref:this});if(e.useChips===!0)return c.value.length===0?$():c.value.map((_,C)=>Q(J,{key:"file-"+C,removable:d.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{F(C)}},()=>Q("span",{class:"ellipsis",textContent:_.name})));const r=e.displayValue!==void 0?e.displayValue:L.value;return r.length!==0?[Q("div",{class:e.inputClass,style:e.inputStyle,textContent:r})]:$()}function ce(){const r={ref:b,...z.value,...j.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:le};return e.multiple===!0&&(r.multiple=!0),Q("input",r)}return Object.assign(d,{fieldClass:i,emitValue:m,hasValue:S,inputRef:b,innerValue:c,floatingLabel:p(()=>S.value===!0||ne(e.displayValue)),computedCounter:p(()=>{if(e.counterLabel!==void 0)return e.counterLabel(V.value);const r=e.maxFiles;return`${c.value.length}${r!==void 0?" / "+r:""} (${l.value})`}),getControlChild:()=>O("file"),getControl:()=>{const r={ref:d.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return d.editable.value===!0&&Object.assign(r,{onDragover:u,onDragleave:o,onKeydown:y,onKeyup:K}),Q("div",r,[ce()].concat(re()))}}),Object.assign(t,{removeAtIndex:F,removeFile:k,getNativeElement:()=>b.value}),ke(t,"nativeEl",()=>b.value),_e(d)}});const ut=e=>(Me("data-v-ce703aba"),e=e(),We(),e),it={class:"row"},st={class:"text-h6 q-px-sm"},ot=ut(()=>B("br",null,null,-1)),rt={class:"ellipsis"},ct=Oe({__name:"FinanceRequestFormPage",setup(e){const g=Ie(),q=Pe(),n=De(),t=U(),d=U();je(()=>{g.readSettings(),q.readAllUsers(),n.readFinanceRequestData()});async function b(R){d.value&&URL.revokeObjectURL(d.value),d.value=URL.createObjectURL(R);const u=await He(d.value);n.financeRequest.file&&t.value&&(n.financeRequest.file.base64=u,n.financeRequest.file.name=t.value.name)}Le(()=>{d.value&&URL.revokeObjectURL(d.value)});const x=p(()=>!n.financeRequest.newValue||!n.financeRequest.userRecipient),h=p(()=>{const R=n.financeRequest.fieldType;return R==="number"?{type:"number",rules:[u=>!!u||"Required",u=>/^\d*\.?\d*$/.test(u.toString())||"Only numbers are allowed"]}:R==="date"?{type:"date",rules:[u=>!!u||"Required"]}:{type:"text",rules:[u=>!!u||"Required"]}});return(R,u)=>(A(),M(Ge,{view:"hHh lpR fFf"},{default:f(()=>[s(ve,null,{default:f(()=>[s(me,{class:"bg-primary"},{default:f(()=>[s(fe,null,{default:f(()=>[N(" Finance Request Form ")]),_:1})]),_:1})]),_:1}),s(Je,null,{default:f(()=>[s(Xe,null,{default:f(()=>[s(ae,null,{default:f(()=>[B("div",it,[s(H,{header:""},{default:f(()=>[N(P(v(n).financeRequest.itemCode),1)]),_:1}),s(Z),B("span",null,[s(J,{color:"blue-5","text-color":"white"},{default:f(()=>[N(P(v(n).financeRequest.customerRecipient),1)]),_:1})])]),s(E,null,{default:f(()=>[s(H,null,{default:f(()=>[N(P(v(n).financeRequest.itemDescription),1)]),_:1})]),_:1})]),_:1}),s(ae,{style:{"min-height":"460px"}},{default:f(()=>[s(X,null,{default:f(()=>[s(H,null,{default:f(()=>[N("Requester")]),_:1}),s(T,{modelValue:v(g).loggedUser.fullName,"onUpdate:modelValue":u[0]||(u[0]=o=>v(g).loggedUser.fullName=o),readonly:"",dense:""},null,8,["modelValue"]),s(H,null,{default:f(()=>[N("Request to")]),_:1}),s(pe,null,{default:f(()=>[(A(!0),Te(Be,null,Ae(v(q).userDeptHeads,(o,w)=>(A(),M(E,{key:w,clickable:"",onClick:O=>v(n).financeRequest.userRecipient=o,active:v(n).financeRequest.userRecipient===o,"active-class":"menu-active",dense:""},{default:f(()=>[s(ge,{avatar:""},{default:f(()=>[s(E,{class:"items-center q-mx-sm q-px-xs"},{default:f(()=>[s(ue,{size:"sm","text-color":"white",style:Ee({backgroundColor:o.color})},{default:f(()=>[N(P(o.initials),1)]),_:2},1032,["style"]),B("span",st,P(o.fullName),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:1}),ot,s(T,{modelValue:v(n).financeRequest.fieldName,"onUpdate:modelValue":u[1]||(u[1]=o=>v(n).financeRequest.fieldName=o),label:"Field",disable:"",outlined:"",dense:""},null,8,["modelValue"]),s(X,{horizontal:"",class:"q-gutter-md"},{default:f(()=>[s(T,{modelValue:v(n).financeRequest.originalValue,"onUpdate:modelValue":u[2]||(u[2]=o=>v(n).financeRequest.originalValue=o),label:"Original Value",type:h.value.type,disable:"",outlined:"",dense:"","input-style":h.value.type==="number"?"text-align: right":""},null,8,["modelValue","type","input-style"]),s(Z),v(n).financeRequest.fieldOptions?(A(),M(Ye,{key:0,modelValue:v(n).financeRequest.newValue,"onUpdate:modelValue":u[3]||(u[3]=o=>v(n).financeRequest.newValue=o),options:v(n).financeRequest.fieldOptions,label:"New Value","emit-value":"",outlined:"",dense:"",style:{"min-width":"200px"}},null,8,["modelValue","options"])):(A(),M(T,{key:1,modelValue:v(n).financeRequest.newValue,"onUpdate:modelValue":u[4]||(u[4]=o=>v(n).financeRequest.newValue=o),label:"New Value",type:h.value.type,rules:h.value.rules,outlined:"",dense:"","input-style":h.value.type==="number"?"text-align: right":""},null,8,["modelValue","type","rules","input-style"]))]),_:1}),s(X,null,{default:f(()=>[s(v(nt),{modelValue:t.value,"onUpdate:modelValue":[u[5]||(u[5]=o=>t.value=o),b],label:"Attach File",outlined:"",clearable:"",dense:""},{file:f(({file:o})=>[s(J,{size:"sm",color:"primary text-white"},{default:f(()=>[s(ue,null,{default:f(()=>[s($e,{name:"description"})]),_:1}),B("div",rt,P(o.name),1)]),_:2},1024)]),_:1},8,["modelValue"]),s(T,{modelValue:v(n).financeRequest.requestMessage,"onUpdate:modelValue":u[6]||(u[6]=o=>v(n).financeRequest.requestMessage=o),label:"Request Message",type:"textarea",autogrow:"",outlined:"",dense:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(et,{style:{"background-color":"var(--primary-white)"},class:"text-white"},{default:f(()=>[s(E,null,{default:f(()=>[s(ie,{color:"primary",type:"cancel",label:"Cancel",onClick:u[7]||(u[7]=o=>v(n).cancelFinanceRequest())}),s(Z),s(ie,{color:"primary",type:"submit",label:"Submit Request",onClick:u[8]||(u[8]=o=>v(n).sendFinanceRequest()),disable:x.value},null,8,["disable"])]),_:1})]),_:1})]),_:1}))}});var _t=Ne(ct,[["__scopeId","data-v-ce703aba"]]);export{_t as default};
