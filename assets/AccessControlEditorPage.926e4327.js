import{Q as V}from"./QToolbarTitle.29b725c6.js";import{Q as $,a as b,b as I}from"./use-form.cea6cf70.js";import{Q as N,a as h}from"./QItem.a88d67c3.js";import{k as x,u as O,o as f,m as g,w as s,n as t,s as _,i as U,a1 as E,p as l,a2 as F,_ as P,t as L,R as k,B as j,a5 as R,Q as w,aQ as q,aR as z,H as J,a0 as B,a8 as T,$ as K,a9 as H}from"./index.1092cc0f.js";import{Q as W}from"./QBtnGroup.3a4d8e62.js";import{Q as D}from"./QList.642b65d3.js";import{Q as X}from"./QPage.56f956df.js";import{Q as M}from"./QBadge.f4f5beca.js";import{Q as A}from"./QToggle.3b8d416d.js";import{Q as Y}from"./QInput.fcacfa1a.js";import{Q as Z}from"./QCardActions.533c9f4f.js";import{Q as ee}from"./QToolbar.8d94931d.js";import"./use-checkbox.8c762ec3.js";import"./option-sizes.20074a77.js";const te=x({__name:"GroupListCard",setup(S){const e=O();return(v,i)=>(f(),g($,{style:{width:"16rem"}},{default:s(()=>[t(b,null,{default:s(()=>[t(V,null,{default:s(()=>[_("Groups")]),_:1})]),_:1}),t(D,null,{default:s(()=>[(f(!0),U(F,null,E(l(e).groups,(p,r)=>{var o;return f(),g(N,{key:r,clickable:"",onClick:d=>l(e).selectGroup(r),class:"bg-grey-2 menu",active:((o=l(e).selectedGroup)==null?void 0:o.id)===r,"active-class":"menu-active"},{default:s(()=>[t(h,null,{default:s(()=>[t(I,{class:"text-h5"},{default:s(()=>[_(L(p.name),1)]),_:2},1024)]),_:2},1024),t(h,{side:""},{default:s(()=>[t(M,{rounded:"",color:"green"},{default:s(()=>[_(L(l(e).groupSummary[r].hasAccessTrue),1)]),_:2},1024),t(M,{rounded:"",color:"red"},{default:s(()=>[_(L(l(e).groupSummary[r].hasAccessFalse),1)]),_:2},1024),t(M,{rounded:"",color:"grey"},{default:s(()=>[_(L(l(e).groupSummary[r].hasAccessNull),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick","active"])}),128))]),_:1})]),_:1}))}});var se=P(te,[["__scopeId","data-v-1f3304a3"]]);const oe={class:"sticky-top"},le=x({__name:"LayoutsListCard",setup(S){const e=O(),v=k(!0),i=k(!0),p=k(!0),r=k(""),o=j(()=>{var a;return Object.entries(((a=e.selectedGroup)==null?void 0:a.layouts)||{}).filter(([u,c])=>{var Q;const y=e.layouts&&((Q=e.layouts[u])==null?void 0:Q.name)||"",G=r.value?y.toLowerCase().includes(r.value.toLowerCase()):!0,C=c.hasAccess===!0&&v.value||c.hasAccess===!1&&i.value||c.hasAccess===null&&p.value;return G&&C}).map(([u,c])=>{var G;const y=e.layouts&&((G=e.layouts[u])==null?void 0:G.name)||"";return{id:u,layout:c,layoutName:y,badgeColor:c.hasAccess===!0?"green":c.hasAccess===!1?"red":"grey"}}).reduce((u,{id:c,layout:y,layoutName:G,badgeColor:C})=>({...u,[c]:{layout:y,layoutName:G,badgeColor:C}}),{})}),d=m=>{z("ADM | Open Layout",{LayoutName:m})},n=j(()=>Object.entries(o.value).sort(([m],[a])=>{var y,G,C,Q;const u=((G=(y=e.layouts)==null?void 0:y[m])==null?void 0:G.name)||"",c=((Q=(C=e.layouts)==null?void 0:C[a])==null?void 0:Q.name)||"";return u.localeCompare(c)}).reduce((m,[a,u])=>({...m,[a]:u}),{}));return(m,a)=>(f(),g($,{class:"card",style:{width:"20rem"}},{default:s(()=>[R("div",oe,[t(b,null,{default:s(()=>[t(V,null,{default:s(()=>{var u;return[_("Layouts on "+L((u=l(e).selectedGroup)==null?void 0:u.name),1)]}),_:1})]),_:1}),t(Z,null,{default:s(()=>[t(A,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=u=>v.value=u),label:"Has Access",color:"green"},null,8,["modelValue"]),t(A,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=u=>i.value=u),label:"No Access",color:"red"},null,8,["modelValue"]),t(A,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=u=>p.value=u),label:"Undefined",color:"grey"},null,8,["modelValue"]),t(Y,{modelValue:r.value,"onUpdate:modelValue":a[3]||(a[3]=u=>r.value=u),label:"Search",outlined:"","clear-icon":"sym_o_close",clearable:"",icon:"sym_o_search",dense:"",type:"search",class:"q-ma-md"},null,8,["modelValue"])]),_:1})]),t(D,{class:"scrollable-list"},{default:s(()=>[(f(!0),U(F,null,E(n.value,(u,c)=>(f(),g(N,{key:c,class:"bg-grey-2 menu",clickable:"",onClick:y=>l(e).selectLayout(c,l(e).layouts&&l(e).layouts[c]?l(e).layouts[c].name:""),active:l(e).selectedLayout.id===c,"active-class":"menu-active"},{default:s(()=>[t(h,null,{default:s(()=>[t(I,{class:"text-h5"},{default:s(()=>[_(L(l(e).layouts&&l(e).layouts[c]?l(e).layouts[c].name:""),1)]),_:2},1024)]),_:2},1024),t(h,{side:""},{default:s(()=>[t(M,{rounded:"",color:o.value[c].badgeColor},null,8,["color"]),t(w,{dense:"",icon:"sym_o_open_in_new",onClick:q(y=>d(l(e).layouts&&l(e).layouts[c]?l(e).layouts[c].name:""),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:1})]),_:1}))}});var ae=P(le,[["__scopeId","data-v-7950175d"]]);const ue=x({__name:"GroupLayoutOptionsCard",setup(S){const e=O(),v=k(null),i=r=>{if(!r&&e.selectedGroup&&(v.value=e.selectedGroup.menu[e.selectedLayout.id].order,e.selectedGroup.id&&e.updateGroupMenu(e.selectedGroup.id,e.selectedLayout.id,r,e.selectedLayout.name,0),p(e.selectedGroup.menu)),r&&e.selectedGroup){const o=Math.max(0,...Object.values(e.selectedGroup.menu).map(d=>d.order));e.selectedGroup.menu.hasOwnProperty(e.selectedLayout.id)?e.selectedGroup.menu[e.selectedLayout.id].order=o+1:e.selectedGroup.menu[e.selectedLayout.id]={name:e.selectedLayout.name,order:o+1},e.selectedGroup.id&&e.updateGroupMenu(e.selectedGroup.id,e.selectedLayout.id,r,e.selectedLayout.name,o+1)}},p=r=>{Object.entries(r).sort(([,d],[,n])=>d.order-n.order).forEach(([d],n)=>{r[d].order=n})};return J(()=>e.selectedGroupLayout.hasAccess,r=>{r||(e.selectedGroupLayout.showInMenu=!1,e.selectedGroup&&e.selectedGroup.id&&e.selectedLayout&&e.selectedLayout.name&&(e.updateGroupMenu(e.selectedGroup.id,e.selectedLayout.id,!1,e.selectedLayout.name,0),p(e.selectedGroup.menu)))}),(r,o)=>B((f(),g($,{style:{width:"20rem"}},{default:s(()=>[t(b,null,{default:s(()=>[t(V,null,{default:s(()=>[_("Group Layout Options")]),_:1})]),_:1}),t(b,null,{default:s(()=>[t(A,{modelValue:l(e).selectedGroupLayout.hasAccess,"onUpdate:modelValue":o[0]||(o[0]=d=>l(e).selectedGroupLayout.hasAccess=d),label:"Has Access"},null,8,["modelValue"])]),_:1}),t(b,null,{default:s(()=>[t(A,{modelValue:l(e).selectedGroupLayout.showInMenu,"onUpdate:modelValue":[o[1]||(o[1]=d=>l(e).selectedGroupLayout.showInMenu=d),i],label:"Show in Menu",disable:!l(e).selectedGroupLayout.hasAccess},null,8,["modelValue","disable"])]),_:1})]),_:1},512)),[[T,l(e).selectedLayout.id!==""]])}}),re=x({__name:"AccessControlEditorToolbar",setup(S){const e=O();return(v,i)=>(f(),g(ee,{inset:""},{default:s(()=>[t(V,null,{default:s(()=>{var p;return[_(L((p=l(e).selectedGroup)==null?void 0:p.name)+" \xBB "+L(l(e).selectedLayout.name),1)]}),_:1}),t(w,{dense:"",icon:"sym_o_save",label:"Save",onClick:i[0]||(i[0]=p=>l(e).saveGroup()),align:"right"})]),_:1}))}});const ne={class:"scrollable-card"},ce=x({__name:"AccessControlEditorPage",setup(S){const e=O();K(()=>{var o;e.toolbar=re,(o=e.selectedGroup)!=null&&o.id||e.selectGroup(Object.keys(e.groups)[0])});const v=j(()=>{var o;return(o=e.selectedGroup)!=null&&o.menu?Object.values(e.selectedGroup.menu).sort((d,n)=>d.order-n.order):[]}),i=(o,d)=>{var m;const n=o.order;o.order=d;for(const a in(m=e.selectedGroup)==null?void 0:m.menu)e.selectedGroup.menu[a].order===d&&e.selectedGroup.menu[a]!==o&&(e.selectedGroup.menu[a].order=n)},p=o=>{var d;if(e.selectedGroup&&o>0){const n=Object.keys(e.selectedGroup.menu).find(m=>{var u;return((u=e.selectedGroup)==null?void 0:u.menu[m].order)===o});n&&typeof((d=e.selectedGroup)==null?void 0:d.menu[n])=="object"&&i(e.selectedGroup.menu[n],e.selectedGroup.menu[n].order-1)}},r=o=>{if(e.selectedGroup){const d=Math.max(...Object.values(e.selectedGroup.menu).map(n=>n.order));if(o<d){const n=Object.keys(e.selectedGroup.menu).find(m=>{var a;return((a=e.selectedGroup)==null?void 0:a.menu[m].order)===o});n&&typeof e.selectedGroup.menu[n]=="object"&&i(e.selectedGroup.menu[n],e.selectedGroup.menu[n].order+1)}}};return(o,d)=>(f(),g(X,{class:"flex"},{default:s(()=>{var n,m;return[t(se),R("div",ne,[B(t(ae,null,null,512),[[T,(n=l(e).selectedGroup)==null?void 0:n.name]])]),t(ue),B(t($,null,{default:s(()=>[t(b,null,{default:s(()=>[t(V,null,{default:s(()=>[_("Menu Preview")]),_:1})]),_:1}),t(b,null,{default:s(()=>[t(D,null,{default:s(()=>[(f(!0),U(F,null,E(v.value,(a,u)=>(f(),g(N,{key:`${u}`,class:"bg-grey-2 menu"},{default:s(()=>[t(h,null,{default:s(()=>[t(I,{class:"text-h5"},{default:s(()=>[_(L(a.name),1)]),_:2},1024)]),_:2},1024),t(h,{side:""},{default:s(()=>[t(W,null,{default:s(()=>[t(w,{onClick:c=>p(a.order)},{default:s(()=>[t(H,{name:"sym_o_move_up"})]),_:2},1032,["onClick"]),t(w,{onClick:c=>r(a.order)},{default:s(()=>[t(H,{name:"sym_o_move_down"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},512),[[T,(m=l(e).selectedGroup)==null?void 0:m.name]])]}),_:1}))}});var Qe=P(ce,[["__scopeId","data-v-9fb7c772"]]);export{Qe as default};
