import{Q as se}from"./QToolbarTitle.6cddce44.js";import{Q as re}from"./QToolbar.9d257d1f.js";import{Q as oe}from"./QHeader.b034dfb4.js";import{f as de,j as ce,g as fe,i as me,k as ve,o as pe,l as Y,h as ge,Q as ye,a as $,c as A}from"./QInput.03268724.js";import{p as be,a as te,Q as G}from"./QSelect.471c5578.js";import{Q as J}from"./QSpace.4ddebd42.js";import{s as le,v as he,x as H,N as U,O as Fe,z as m,F as O,H as Ve,U as qe,A as Q,C as W,D as Re,ak as xe,ae,aj as Se,ac as _e,ah as Ce,_ as Qe,i as ze,u as we,a as Ue,f as Ne,a8 as Oe,T as ke,b4 as Z,o as M,k as E,w as h,l as f,p as Pe,m as v,n as je,a6 as Te,W as Ae,t as De,Q as ee,b5 as Be}from"./index.6003fab6.js";import{Q as Ie}from"./QPage.b6a9d57a.js";import{b as Le,Q as $e,a as He}from"./QLayout.655571af.js";import{Q as Me}from"./QItem.ddac1655.js";var Ee=le({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:p,emit:x}){const{proxy:{$q:u}}=W(),t=he(Re,H);if(t===H)return console.error("QFooter needs to be child of QLayout"),H;const d=U(parseInt(e.heightHint,10)),g=U(!0),S=U(Fe.value===!0||t.isContainer.value===!0?0:window.innerHeight),b=m(()=>e.reveal===!0||t.view.value.indexOf("F")>-1||u.platform.is.ios&&t.isContainer.value===!0),V=m(()=>t.isContainer.value===!0?t.containerHeight.value:S.value),n=m(()=>{if(e.modelValue!==!0)return 0;if(b.value===!0)return g.value===!0?d.value:0;const i=t.scroll.value.position+V.value+d.value-t.height.value;return i>0?i:0}),s=m(()=>e.modelValue!==!0||b.value===!0&&g.value!==!0),N=m(()=>e.modelValue===!0&&s.value===!0&&e.reveal===!0),P=m(()=>"q-footer q-layout__section--marginal "+(b.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+(s.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(b.value!==!0?" hidden":""):"")),j=m(()=>{const i=t.rows.value.bottom,a={};return i[0]==="l"&&t.left.space===!0&&(a[u.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),i[2]==="r"&&t.right.space===!0&&(a[u.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),a});function o(i,a){t.update("footer",i,a)}function _(i,a){i.value!==a&&(i.value=a)}function T({height:i}){_(d,i),o("size",i)}function l(){if(e.reveal!==!0)return;const{direction:i,position:a,inflectionPoint:F}=t.scroll.value;_(g,i==="up"||a-F<100||t.height.value-V.value-a-d.value<300)}function q(i){N.value===!0&&_(g,!0),x("focusin",i)}O(()=>e.modelValue,i=>{o("space",i),_(g,!0),t.animate()}),O(n,i=>{o("offset",i)}),O(()=>e.reveal,i=>{i===!1&&_(g,e.modelValue)}),O(g,i=>{t.animate(),x("reveal",i)}),O([d,t.scroll,t.height],l),O(()=>u.screen.height,i=>{t.isContainer.value!==!0&&_(S,i)});const z={};return t.instances.footer=z,e.modelValue===!0&&o("size",d.value),o("space",e.modelValue),o("offset",n.value),Ve(()=>{t.instances.footer===z&&(t.instances.footer=void 0,o("size",0),o("offset",0),o("space",!1))}),()=>{const i=qe(p.default,[Q(Le,{debounce:0,onResize:T})]);return e.elevated===!0&&i.push(Q("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),Q("footer",{class:P.value,style:j.value,onFocusin:q},i)}}});function k(e,p,x,u){const t=[];return e.forEach(d=>{u(d)===!0?t.push(d):p.push({failedPropValidation:x,file:d})}),t}function B(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),ae(e)}const We={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ke=["rejected"];function Xe({editable:e,dnd:p,getFileInput:x,addFilesToQueue:u}){const{props:t,emit:d,proxy:g}=W(),S=U(null),b=m(()=>t.accept!==void 0?t.accept.split(",").map(l=>(l=l.trim(),l==="*"?"*/":(l.endsWith("/*")&&(l=l.slice(0,l.length-1)),l.toUpperCase()))):null),V=m(()=>parseInt(t.maxFiles,10)),n=m(()=>parseInt(t.maxTotalSize,10));function s(l){if(e.value)if(l!==Object(l)&&(l={target:null}),l.target!==null&&l.target.matches('input[type="file"]')===!0)l.clientX===0&&l.clientY===0&&xe(l);else{const q=x();q&&q!==l.target&&q.click(l)}}function N(l){e.value&&l&&u(null,l)}function P(l,q,z,i){let a=Array.from(q||l.target.files);const F=[],w=()=>{F.length!==0&&d("rejected",F)};if(t.accept!==void 0&&b.value.indexOf("*/")===-1&&(a=k(a,F,"accept",c=>b.value.some(y=>c.type.toUpperCase().startsWith(y)||c.name.toUpperCase().endsWith(y))),a.length===0))return w();if(t.maxFileSize!==void 0){const c=parseInt(t.maxFileSize,10);if(a=k(a,F,"max-file-size",y=>y.size<=c),a.length===0)return w()}if(t.multiple!==!0&&a.length!==0&&(a=[a[0]]),a.forEach(c=>{c.__key=c.webkitRelativePath+c.lastModified+c.name+c.size}),i===!0){const c=z.map(y=>y.__key);a=k(a,F,"duplicate",y=>c.includes(y.__key)===!1)}if(a.length===0)return w();if(t.maxTotalSize!==void 0){let c=i===!0?z.reduce((y,I)=>y+I.size,0):0;if(a=k(a,F,"max-total-size",y=>(c+=y.size,c<=n.value)),a.length===0)return w()}if(typeof t.filter=="function"){const c=t.filter(a);a=k(a,F,"filter",y=>c.includes(y))}if(t.maxFiles!==void 0){let c=i===!0?z.length:0;if(a=k(a,F,"max-files",()=>(c++,c<=V.value)),a.length===0)return w()}if(w(),a.length!==0)return a}function j(l){B(l),p.value!==!0&&(p.value=!0)}function o(l){ae(l),(l.relatedTarget!==null||Se.is.safari!==!0?l.relatedTarget!==S.value:document.elementsFromPoint(l.clientX,l.clientY).includes(S.value)===!1)===!0&&(p.value=!1)}function _(l){B(l);const q=l.dataTransfer.files;q.length!==0&&u(null,q),p.value=!1}function T(l){if(p.value===!0)return Q("div",{ref:S,class:`q-${l}__dnd absolute-full`,onDragenter:B,onDragover:B,onDragleave:o,onDrop:_})}return Object.assign(g,{pickFiles:s,addFiles:N}),{pickFiles:s,addFiles:N,onDragover:j,onDragleave:o,processFiles:P,getDndNode:T,maxFilesNumber:V,maxTotalSizeNumber:n}}var Ye=le({name:"QFile",inheritAttrs:!1,props:{...de,...ce,...We,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...fe,...Ke],setup(e,{slots:p,emit:x,attrs:u}){const{proxy:t}=W(),d=me(),g=U(null),S=U(!1),b=ve(e),{pickFiles:V,onDragover:n,onDragleave:s,processFiles:N,getDndNode:P}=Xe({editable:d.editable,dnd:S,getFileInput:K,addFilesToQueue:X}),j=pe(e),o=m(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),_=m(()=>Y(o.value)),T=m(()=>o.value.map(r=>r.name).join(", ")),l=m(()=>be(o.value.reduce((r,R)=>r+R.size,0))),q=m(()=>({totalSize:l.value,filesNumber:o.value.length,maxFiles:e.maxFiles})),z=m(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:b.value,...u,id:d.targetUid.value,disabled:d.editable.value!==!0})),i=m(()=>"q-file q-field--auto-height"+(S.value===!0?" q-file--dnd":"")),a=m(()=>e.multiple===!0&&e.append===!0);function F(r){const R=o.value.slice();R.splice(r,1),c(R)}function w(r){const R=o.value.indexOf(r);R>-1&&F(R)}function c(r){x("update:modelValue",e.multiple===!0?r:r[0])}function y(r){r.keyCode===13&&Ce(r)}function I(r){(r.keyCode===13||r.keyCode===32)&&V(r)}function K(){return g.value}function X(r,R){const C=N(r,R,o.value,a.value),L=K();L!=null&&(L.value=""),C!==void 0&&((e.multiple===!0?e.modelValue&&C.every(ie=>o.value.includes(ie)):e.modelValue===C[0])||c(a.value===!0?o.value.concat(C):C))}function D(){return[Q("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function ne(){if(p.file!==void 0)return o.value.length===0?D():o.value.map((R,C)=>p.file({index:C,file:R,ref:this}));if(p.selected!==void 0)return o.value.length===0?D():p.selected({files:o.value,ref:this});if(e.useChips===!0)return o.value.length===0?D():o.value.map((R,C)=>Q(te,{key:"file-"+C,removable:d.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{F(C)}},()=>Q("span",{class:"ellipsis",textContent:R.name})));const r=e.displayValue!==void 0?e.displayValue:T.value;return r.length!==0?[Q("div",{class:e.inputClass,style:e.inputStyle,textContent:r})]:D()}function ue(){const r={ref:g,...z.value,...j.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:X};return e.multiple===!0&&(r.multiple=!0),Q("input",r)}return Object.assign(d,{fieldClass:i,emitValue:c,hasValue:_,inputRef:g,innerValue:o,floatingLabel:m(()=>_.value===!0||Y(e.displayValue)),computedCounter:m(()=>{if(e.counterLabel!==void 0)return e.counterLabel(q.value);const r=e.maxFiles;return`${o.value.length}${r!==void 0?" / "+r:""} (${l.value})`}),getControlChild:()=>P("file"),getControl:()=>{const r={ref:d.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return d.editable.value===!0&&Object.assign(r,{onDragover:n,onDragleave:s,onKeydown:y,onKeyup:I}),Q("div",r,[ue()].concat(ne()))}}),Object.assign(t,{removeAtIndex:F,removeFile:w,getNativeElement:()=>g.value}),_e(t,"nativeEl",()=>g.value),ge(d)}});const Ge={class:"ellipsis"},Je=ze({__name:"FinanceRequestFormPage",setup(e){const p=we(),x=Ue(),u=Ne(),t=U(),d=U();Oe(()=>{p.readSettings(),x.readAllUsers(),u.readFinanceRequestData()});async function g(V){d.value&&Z(d.value),d.value=URL.createObjectURL(V);const n=await Be(d.value);u.financeRequest.file&&t.value&&(u.financeRequest.file.base64=n,u.financeRequest.file.name=t.value.name)}ke(()=>{d.value&&Z(d.value)});const S=m(()=>!u.financeRequest.newValue||!u.financeRequest.requestMessage||!u.recipientOption.value),b=m(()=>{const V=u.financeRequest.fieldType;return V==="number"?{type:"number",rules:[n=>!!n||"Required",n=>/^\d*\.?\d*$/.test(n.toString())||"Only numbers are allowed"]}:V==="date"?{type:"date",rules:[n=>!!n||"Required"]}:{type:"text",rules:[n=>!!n||"Required"]}});return(V,n)=>(M(),E($e,{view:"hHh lpR fFf"},{default:h(()=>[f(oe,null,{default:h(()=>[f(re,{class:"bg-primary"},{default:h(()=>[f(se,null,{default:h(()=>[Pe(" Finance Request Form ")]),_:1})]),_:1})]),_:1}),f(He,null,{default:h(()=>[f(Ie,null,{default:h(()=>[f(ye,{style:{"min-height":"450px"}},{default:h(()=>[f($,null,{default:h(()=>[f(A,{modelValue:v(p).loggedUser.fullName,"onUpdate:modelValue":n[0]||(n[0]=s=>v(p).loggedUser.fullName=s),label:"Requester",readonly:"",dense:""},null,8,["modelValue"]),f(G,{modelValue:v(u).recipientOption,"onUpdate:modelValue":n[1]||(n[1]=s=>v(u).recipientOption=s),options:v(x).userOptions,label:"Request to","lazy-rules":"",rules:[s=>!!s||"Required"],outlined:"",dense:""},null,8,["modelValue","options","rules"]),f(A,{modelValue:v(u).financeRequest.fieldName,"onUpdate:modelValue":n[2]||(n[2]=s=>v(u).financeRequest.fieldName=s),label:"Field",disable:"",outlined:"",dense:""},null,8,["modelValue"]),f($,{horizontal:"",class:"q-gutter-md"},{default:h(()=>[f(A,{modelValue:v(u).financeRequest.originalValue,"onUpdate:modelValue":n[3]||(n[3]=s=>v(u).financeRequest.originalValue=s),label:"Original Value",type:b.value.type,disable:"",outlined:"",dense:"","input-style":b.value.type==="number"?"text-align: right":""},null,8,["modelValue","type","input-style"]),f(J),v(u).financeRequest.fieldOptions?(M(),E(G,{key:0,modelValue:v(u).financeRequest.newValue,"onUpdate:modelValue":n[4]||(n[4]=s=>v(u).financeRequest.newValue=s),options:v(u).financeRequest.fieldOptions,label:"New Value","emit-value":"",outlined:"",dense:"",style:{"min-width":"200px"}},null,8,["modelValue","options"])):(M(),E(A,{key:1,modelValue:v(u).financeRequest.newValue,"onUpdate:modelValue":n[5]||(n[5]=s=>v(u).financeRequest.newValue=s),label:"New Value",type:b.value.type,rules:b.value.rules,outlined:"",dense:"","input-style":b.value.type==="number"?"text-align: right":""},null,8,["modelValue","type","rules","input-style"]))]),_:1}),f($,null,{default:h(()=>[f(v(Ye),{modelValue:t.value,"onUpdate:modelValue":[n[6]||(n[6]=s=>t.value=s),g],label:"Attach File",outlined:"",clearable:"",dense:""},{file:h(({file:s})=>[f(te,{size:"sm",color:"primary text-white"},{default:h(()=>[f(je,null,{default:h(()=>[f(Te,{name:"description"})]),_:1}),Ae("div",Ge,De(s.name),1)]),_:2},1024)]),_:1},8,["modelValue"]),f(A,{modelValue:v(u).financeRequest.requestMessage,"onUpdate:modelValue":n[7]||(n[7]=s=>v(u).financeRequest.requestMessage=s),label:"Request Message","lazy-rules":"",type:"textarea",autogrow:"",rules:[s=>!!s||"Required"],outlined:"",dense:""},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),f(Ee,{style:{"background-color":"var(--primary-white)"},class:"text-white"},{default:h(()=>[f(Me,null,{default:h(()=>[f(ee,{color:"primary",type:"cancel",label:"Cancel",onClick:n[8]||(n[8]=s=>v(u).cancelFinanceRequest())}),f(J),f(ee,{color:"primary",type:"submit",label:"Submit Request",onClick:n[9]||(n[9]=s=>v(u).sendFinanceRequest()),disable:S.value},null,8,["disable"])]),_:1})]),_:1})]),_:1}))}});var ot=Qe(Je,[["__scopeId","data-v-6bee9cd8"]]);export{ot as default};
