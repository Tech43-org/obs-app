import{Q as Qe,a as Ce}from"./QToolbar.05b7048b.js";import{N as K,a as Z,u as ke,y as I,w as Q,F as A,G as M,H as f,P as y,I as a,Y as x,Q as L,a4 as H,Z as $,K as ie,aL as Ee,h as S,aM as ll,e as gt,L as yt,X as al,W as _t,_ as St,aN as ue,aO as rl,aP as nl,f as X,j as g,k as re,l as ne,V as ol,O as je,o as pt,au as sl,ae as ul,q as wt,s as il,t as rt,D as Ut,a5 as dl,a6 as cl,ac as vl,ab as nt,aQ as Le,aR as ot,aS as fl,J as Ct,aT as ml,as as oe,aU as bl,aV as pe,aW as st}from"./index.f7f23956.js";import{j as ht,d as O,f as de,e as ut,Q as Tt,a as he,h as kt,u as gl,k as yl,l as qt,i as _l,b as Sl}from"./QSeparator.df9fb602.js";import{Q as pl,a as wl}from"./QBadge.4b0f0f9a.js";import{Q as Ul}from"./QPage.4d4a215e.js";import{c as G,a as qe,Q as W,b as Pt,u as ze,d as He}from"./QList.2c7d391b.js";import{a as E,Q as J,d as Me}from"./QCheckbox.3777a59d.js";import{Q as Cl}from"./QBtnGroup.52ca4323.js";import"./QResizeObserver.21977435.js";const hl=ie("br",null,null,-1),Tl=K({__name:"UserCreateDrawer",setup(e){const t=Z(),n=ke(),i=I({subject:"",body:""});Q(()=>({givenName:t.user.givenName,surname:t.user.surname}),m=>{i.value.subject=`Onboarding ${m.givenName} ${m.surname}`,i.value.body=`Please add ${m.givenName} to the Active Directory.
Name: ${m.givenName}
Surname: ${m.surname}

Thanks

This email has been sent from FileMaker by ${n.user.fullName}`},{immediate:!0});const s=()=>{t.user={givenName:"",surname:"",status:"Pending",groupId:null}};return(m,o)=>(A(),M(ht,{modelValue:y(t).createMode,"onUpdate:modelValue":o[5]||(o[5]=r=>y(t).createMode=r),onBeforeShow:o[6]||(o[6]=r=>s()),width:384,bordered:"",overlay:"",side:"right"},{default:f(()=>[a(J,null,{default:f(()=>[a(E,null,{default:f(()=>[a(Qe,null,{default:f(()=>[x(" Create User ")]),_:1}),a(G,{class:"text-body2"},{default:f(()=>[x(" A new User will be created and, an email request to add him/her to Active Directory will be send ")]),_:1}),hl,a(L,{dense:"",label:"Create User and Send Request",icon:"person_add",color:"primary",onClick:o[0]||(o[0]=r=>y(t).createUser(i.value)),disable:!y(t).user.givenName||!y(t).user.surname},null,8,["disable"])]),_:1}),a(E,null,{default:f(()=>[a(O,{modelValue:y(t).user.givenName,"onUpdate:modelValue":o[1]||(o[1]=r=>y(t).user.givenName=r),label:"Name",rules:[r=>!!r||"Name is required"]},null,8,["modelValue","rules"]),a(O,{modelValue:y(t).user.surname,"onUpdate:modelValue":o[2]||(o[2]=r=>y(t).user.surname=r),label:"Surname",rules:[r=>!!r||"Surname is required"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),a(J,{class:"bg-blue-2"},{default:f(()=>[a(E,null,{default:f(()=>[a(qe,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:f(()=>[a(W,{avatar:""},{default:f(()=>[a(H,{name:"mail"})]),_:1}),a(W,null,{default:f(()=>[x($(y(n).bookingsSupportEmail),1)]),_:1})]),_:1}),a(O,{modelValue:i.value.subject,"onUpdate:modelValue":o[3]||(o[3]=r=>i.value.subject=r),label:"Subject"},null,8,["modelValue"]),a(O,{modelValue:i.value.body,"onUpdate:modelValue":o[4]||(o[4]=r=>i.value.body=r),label:"Body",type:"textarea",autogrow:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),kl=K({__name:"UserUpdateDrawer",setup(e){const t=Z(),n=ke(),i=I({subject:"",body:""}),s=I(320),m=()=>{t.user=JSON.parse(JSON.stringify(t.selectedUser))},o=()=>{if(t.selectedUser.status!=="Inactive"&&t.user.status==="Inactive"){t.user.groupId=null;const r=t.user.email;t.user.email=null,s.value=720,i.value.subject=`Deauthorize ${t.user.givenName} ${t.user.surname}`,i.value.body=`Please remove ${t.user.givenName} from the Active Directory.
Name: ${t.user.givenName}
Surname: ${t.user.surname}
Email: ${r}
 
Thanks
 
This email has been sent from FileMaker by ${n.user.fullName}`}else s.value=320};return(r,u)=>(A(),M(ht,{modelValue:y(t).editMode,"onUpdate:modelValue":u[11]||(u[11]=v=>y(t).editMode=v),onBeforeShow:u[12]||(u[12]=v=>m()),onBeforeHide:u[13]||(u[13]=v=>s.value=320),width:s.value,bordered:"",overlay:"",side:"right",class:"row"},{default:f(()=>[a(J,{class:"col"},{default:f(()=>[a(E,{horizontal:""},{default:f(()=>[a(Qe,null,{default:f(()=>[x(" Edit User ")]),_:1}),a(L,{dense:"",label:"Save Changes",icon:"save",color:"primary",onClick:u[0]||(u[0]=v=>y(t).updateUser(i.value)),disable:y(t).user.status==="Active"&&!y(t).user.groupId},null,8,["disable"])]),_:1}),a(E,null,{default:f(()=>[a(O,{modelValue:y(t).user.givenName,"onUpdate:modelValue":u[1]||(u[1]=v=>y(t).user.givenName=v),label:"Name"},null,8,["modelValue"]),a(O,{modelValue:y(t).user.surname,"onUpdate:modelValue":u[2]||(u[2]=v=>y(t).user.surname=v),label:"Surname"},null,8,["modelValue"]),a(O,{modelValue:y(t).user.loginName,"onUpdate:modelValue":u[3]||(u[3]=v=>y(t).user.loginName=v),label:"Login"},null,8,["modelValue"]),a(O,{modelValue:y(t).user.email,"onUpdate:modelValue":u[4]||(u[4]=v=>y(t).user.email=v),label:"Email",type:"email",rules:[v=>!v||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(v)||"Invalid email"]},null,8,["modelValue","rules"]),a(O,{modelValue:y(t).user.note,"onUpdate:modelValue":u[5]||(u[5]=v=>y(t).user.note=v),label:"Note",type:"textarea"},null,8,["modelValue"])]),_:1}),a(E,{style:{"background-color":"rgb(197, 198, 198)","border-radius":"4%"}},{default:f(()=>[a(de,{modelValue:y(t).user.status,"onUpdate:modelValue":[u[6]||(u[6]=v=>y(t).user.status=v),u[7]||(u[7]=v=>o())],label:"Status",options:y(t).statusOptions},null,8,["modelValue","options"]),a(de,{modelValue:y(t).user.groupId,"onUpdate:modelValue":u[8]||(u[8]=v=>y(t).user.groupId=v),"emit-value":"","map-options":"",label:"Group",clearable:"",disable:y(t).user.status!=="Active",options:y(n).groupsOptions},null,8,["modelValue","disable","options"])]),_:1}),y(t).user.status==="Active"&&(y(t).user.groupId===null||y(t).user.groupId==="")?(A(),M(E,{key:0},{default:f(()=>[a(ut,{class:"bg-orange text-white",rounded:""},{avatar:f(()=>[a(H,{name:"warning"})]),default:f(()=>[x(" Select a Group before saving changes ")]),_:1})]),_:1})):Ee("",!0)]),_:1}),y(t).selectedUser.status!=="Inactive"&&y(t).user.status==="Inactive"?(A(),M(J,{key:0,class:"col"},{default:f(()=>[a(E,null,{default:f(()=>[a(ut,{class:"bg-red text-white",rounded:""},{avatar:f(()=>[a(H,{name:"warning"})]),default:f(()=>[x(" You are going to inactivate this user, the email and the group associated will be removed and an email to unauthorized the user will be sent. ")]),_:1})]),_:1}),a(J,{class:"bg-blue-2"},{default:f(()=>[a(E,null,{default:f(()=>[a(qe,{style:{"background-color":"hsl(200, 50%, 90%)"}},{default:f(()=>[a(W,{avatar:""},{default:f(()=>[a(H,{name:"mail"})]),_:1}),a(W,null,{default:f(()=>[x($(y(n).bookingsSupportEmail),1)]),_:1})]),_:1}),a(O,{modelValue:i.value.subject,"onUpdate:modelValue":u[9]||(u[9]=v=>i.value.subject=v),label:"Subject"},null,8,["modelValue"]),a(O,{modelValue:i.value.body,"onUpdate:modelValue":u[10]||(u[10]=v=>i.value.body=v),label:"Body",type:"textarea",autogrow:"",hint:"The email can be personalized before sending it."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):Ee("",!0)]),_:1},8,["modelValue","width"]))}}),ql=K({__name:"UsersSearch",setup(e){const t=Z();return(n,i)=>(A(),M(O,{modelValue:y(t).searchTerm,"onUpdate:modelValue":i[1]||(i[1]=s=>y(t).searchTerm=s),type:"search",placeholder:"Search\u2026",outlined:""},{append:f(()=>[y(t).searchTerm?(A(),M(H,{key:0,name:"close",class:"cursor-pointer",onClick:i[0]||(i[0]=s=>y(t).searchTerm="")})):(A(),M(H,{key:1,name:"search"}))]),_:1},8,["modelValue"]))}}),Pl=[{label:"Activity ID",value:"activityId",table:"z_ACT_Activity",field:"_kplt_Activity",type:"text",sql:"act"},{label:"Created At",value:"createdAt",table:"z_ACT_Activity",field:"CreatedAtUnix",type:"number",sql:"act"},{label:"Performer User ID",value:"performerUserId",table:"z_ACT_Activity",field:"_kflt_User_Performer",type:"text",sql:"act"},{label:"Performer User Name",value:"performerUserName",table:"z_CD_USE_Users",field:"Name",type:"text",sql:"use1"},{label:"Performer User Surname",value:"performerUserSurname",table:"z_CD_USE_Users",field:"Surname",type:"text",sql:"use1"},{label:"Related User ID",value:"relatedUserId",table:"z_ACT_Activity",field:"_kflt_User_Related",type:"text",sql:"act"},{label:"Related User Name",value:"relatedUserName",table:"z_CD_USE_Users",field:"Name",type:"text",sql:"use2"},{label:"Related User Surname",value:"relatedUserSurname",table:"z_CD_USE_Users",field:"Surname",type:"text",sql:"use2"},{label:"Action",value:"action",table:"z_ACT_Activity",field:"Action",type:"text",sql:"act"},{label:"Description",value:"description",table:"z_ACT_Activity",field:"Description",type:"text",sql:"act"},{label:"Note",value:"note",table:"z_ACT_Activity",field:"Note",type:"text",sql:"act"}],Te=S(()=>ll(Pl));S(()=>I("SELECT "+Te.value.map(t=>t)+" FROM z_ACT_Activity AS act").value);const xl=S(()=>{const e=Z(),t=I("SELECT "+Te.value.map(n=>n)+" FROM z_ACT_Activity AS act");return Te.value.some(n=>n.indexOf("use1.")!==-1)&&(t.value+=' LEFT OUTER JOIN z_CD_USE_Users AS use1 ON use1."_kplt_User" = act."_kflt_User_Performer" '),Te.value.some(n=>n.indexOf("use2.")!==-1)&&(t.value+=' LEFT OUTER JOIN z_CD_USE_Users AS use2 ON use2."_kplt_User" = act."_kflt_User_Related" '),t.value+=` WHERE act."_kflt_User_Performer" ='${e.selectedUser.userId}' OR act."_kflt_User_Related" ='${e.selectedUser.userId}'`,t.value});const Dl=K({__name:"UsersList",setup(e){const t=Z(),n=gt(),i=s=>{t.selectedUser=s,t.editMode=!1,t.createMode=!1,n.readActivity(xl.value)};return(s,m)=>(A(),M(J,{style:{width:"20rem"}},{default:f(()=>[a(Tt,null,{default:f(()=>[a(ql)]),_:1}),a(Pt,null,{default:f(()=>[(A(!0),yt(_t,null,al(y(t).filterUsers,o=>(A(),M(qe,{key:o.userId,clickable:"",onClick:r=>i(o),class:"bg-grey-2 menu",active:y(t).selectedUser===o,"active-class":"menu-active"},{default:f(()=>[a(W,{avatar:""},{default:f(()=>[a(ue,{style:rl({backgroundColor:o.color}),class:"text-white"},{default:f(()=>[x($(o.initials),1)]),_:2},1032,["style"])]),_:2},1024),a(W,null,{default:f(()=>[a(G,{class:"text-h4"},{default:f(()=>[x($(o.givenName),1)]),_:2},1024),a(G,{class:"text-h5"},{default:f(()=>[x($(o.surname),1)]),_:2},1024)]),_:2},1024),a(W,{side:"",top:""},{default:f(()=>[a(pl,{rounded:"",color:o.status==="Active"?"green":o.status==="Pending"?"orange":"grey"},null,8,["color"])]),_:2},1024)]),_:2},1032,["onClick","active"]))),128))]),_:1})]),_:1}))}});var Vl=St(Dl,[["__scopeId","data-v-10b34f94"]]);const Rl=K({__name:"UserAvatar",setup(e){const t=Z();return(n,i)=>(A(),M(ue,nl({style:{backgroundColor:y(t).selectedUser.color},class:"text-white"},n.$attrs),{default:f(()=>[x($(y(t).selectedUser.initials),1)]),_:1},16,["style"]))}}),Nl=K({__name:"UserInfoCard",setup(e){const t=Z(),n=ke();return(i,s)=>(A(),M(J,{style:{width:"20rem"}},{default:f(()=>[a(E,{class:"row"},{default:f(()=>[a(he),a(kt,{dark:"",size:"md",label:y(t).selectedUser.status,color:y(t).selectedUser.status==="Active"?"green":y(t).selectedUser.status==="Pending"?"orange":"grey"},null,8,["label","color"])]),_:1}),a(E,{class:"column items-center"},{default:f(()=>[a(Rl,{size:"120px"})]),_:1}),a(E,null,{default:f(()=>[a(G,{class:"text-h3 text-center"},{default:f(()=>{var m;return[x($((m=y(t).selectedUser)==null?void 0:m.givenName),1)]}),_:1}),a(G,{class:"text-h4 text-center"},{default:f(()=>{var m;return[x($((m=y(t).selectedUser)==null?void 0:m.surname),1)]}),_:1})]),_:1}),a(E,{class:"bg-blue-2"},{default:f(()=>[a(qe,null,{default:f(()=>[a(W,{avatar:""},{default:f(()=>[a(G,null,{default:f(()=>[x("Group")]),_:1}),a(G,{class:"text-h4"},{default:f(()=>[x($(y(t).selectedUser.groupId?y(n).groups[y(t).selectedUser.groupId].name:"No Group"),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});var ae=X({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(e,{slots:t}){const n=ne(),i=S(()=>"q-td"+(e.autoWidth===!0?" q-table--col-auto-width":"")+(e.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(e.props===void 0)return g("td",{class:i.value},re(t.default));const s=n.vnode.key,m=(e.props.colsMap!==void 0?e.props.colsMap[s]:null)||e.props.col;if(m===void 0)return;const{row:o}=e.props;return g("td",{class:i.value+m.__tdClass(o),style:m.__tdStyle(o)},re(t.default))}}}),$l=X({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:t}){const n=S(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>g("tr",{class:n.value},re(t.default))}}),Al=X({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(e,{slots:t,emit:n}){const i=ne(),{proxy:{$q:s}}=i,m=o=>{n("click",o)};return()=>{if(e.props===void 0)return g("th",{class:e.autoWidth===!0?"q-table--col-auto-width":"",onClick:m},re(t.default));let o,r;const u=i.vnode.key;if(u){if(o=e.props.colsMap[u],o===void 0)return}else o=e.props.col;if(o.sortable===!0){const d=o.align==="right"?"unshift":"push";r=ol(t.default,[]),r[d](g(H,{class:o.__iconClass,name:s.iconSet.table.arrowUp}))}else r=re(t.default);const v={class:o.__thClass+(e.autoWidth===!0?" q-table--col-auto-width":""),style:o.headerStyle,onClick:d=>{o.sortable===!0&&e.props.sort(o),m(d)}};return g("th",v,r)}}});const Fl=["horizontal","vertical","cell","none"];var Ol=X({name:"QMarkupTable",props:{...ze,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>Fl.includes(e)}},setup(e,{slots:t}){const n=ne(),i=He(e,n.proxy.$q),s=S(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(i.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>g("div",{class:s.value},[g("table",{class:"q-table"},re(t.default))])}});function xt(e,t){return g("div",e,[g("table",{class:"q-table"},t)])}const Bl={list:Pt,table:Ol},Il=["list","table","__qtable"];var Ml=X({name:"QVirtualScroll",props:{...gl,type:{type:String,default:"list",validator:e=>Il.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:t,attrs:n}){let i;const s=I(null),m=S(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:o,localResetVirtualScroll:r,padVirtualScroll:u,onVirtualScrollEvt:v}=yl({virtualScrollLength:m,getVirtualScrollTarget:b,getVirtualScrollEl:w}),d=S(()=>{if(m.value===0)return[];const F=(R,q)=>({index:o.value.from+q,item:R});return e.itemsFn===void 0?e.items.slice(o.value.from,o.value.to).map(F):e.itemsFn(o.value.from,o.value.to-o.value.from).map(F)}),C=S(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),k=S(()=>e.scrollTarget!==void 0?{}:{tabindex:0});Q(m,()=>{r()}),Q(()=>e.scrollTarget,()=>{p(),c()});function w(){return s.value.$el||s.value}function b(){return i}function c(){i=il(w(),e.scrollTarget),i.addEventListener("scroll",v,rt.passive)}function p(){i!==void 0&&(i.removeEventListener("scroll",v,rt.passive),i=void 0)}function P(){let F=u(e.type==="list"?"div":"tbody",d.value.map(t.default));return t.before!==void 0&&(F=t.before().concat(F)),Ut(t.after,F)}return je(()=>{r()}),pt(()=>{c()}),sl(()=>{c()}),ul(()=>{p()}),wt(()=>{p()}),()=>{if(t.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?xt({ref:s,class:"q-table__middle "+C.value},P()):g(Bl[e.type],{...n,ref:s,class:[n.class,C.value],...k.value},P)}}});const El={xs:2,sm:4,md:6,lg:10,xl:14};function it(e,t,n){return{transform:t===!0?`translateX(${n.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var Ll=X({name:"QLinearProgress",props:{...ze,...dl,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:t}){const{proxy:n}=ne(),i=He(e,n.$q),s=cl(e,El),m=S(()=>e.indeterminate===!0||e.query===!0),o=S(()=>e.reverse!==e.query),r=S(()=>({...s.value!==null?s.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),u=S(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),v=S(()=>it(e.buffer!==void 0?e.buffer:1,o.value,n.$q)),d=S(()=>`with${e.instantFeedback===!0?"out":""}-transition`),C=S(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${d.value} q-linear-progress__track--${i.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),k=S(()=>it(m.value===!0?1:e.value,o.value,n.$q)),w=S(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${d.value} q-linear-progress__model--${m.value===!0?"in":""}determinate`),b=S(()=>({width:`${e.value*100}%`})),c=S(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${d.value}`);return()=>{const p=[g("div",{class:C.value,style:v.value}),g("div",{class:w.value,style:k.value})];return e.stripe===!0&&m.value===!1&&p.push(g("div",{class:c.value,style:b.value})),g("div",{class:u.value,style:r.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},Ut(t.default,p))}}});let se=0;const Ql={fullscreen:Boolean,noRouteFullscreenExit:Boolean},jl=["update:fullscreen","fullscreen"];function zl(){const e=ne(),{props:t,emit:n,proxy:i}=e;let s,m,o;const r=I(!1);vl(e)===!0&&Q(()=>i.$route.fullPath,()=>{t.noRouteFullscreenExit!==!0&&d()}),Q(()=>t.fullscreen,C=>{r.value!==C&&u()}),Q(r,C=>{n("update:fullscreen",C),n("fullscreen",C)});function u(){r.value===!0?d():v()}function v(){r.value!==!0&&(r.value=!0,o=i.$el.parentNode,o.replaceChild(m,i.$el),document.body.appendChild(i.$el),se++,se===1&&document.body.classList.add("q-body--fullscreen-mixin"),s={handler:d},nt.add(s))}function d(){r.value===!0&&(s!==void 0&&(nt.remove(s),s=void 0),o.replaceChild(i.$el,m),r.value=!1,se=Math.max(0,se-1),se===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),i.$el.scrollIntoView!==void 0&&setTimeout(()=>{i.$el.scrollIntoView()})))}return je(()=>{m=document.createElement("span")}),pt(()=>{t.fullscreen===!0&&v()}),wt(d),Object.assign(i,{toggleFullscreen:u,setFullscreen:v,exitFullscreen:d}),{inFullscreen:r,toggleFullscreen:u}}function Hl(e,t){return new Date(e)-new Date(t)}const Yl={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:e=>e==="ad"||e==="da",default:"ad"}};function Gl(e,t,n,i){const s=S(()=>{const{sortBy:r}=t.value;return r&&n.value.find(u=>u.name===r)||null}),m=S(()=>e.sortMethod!==void 0?e.sortMethod:(r,u,v)=>{const d=n.value.find(w=>w.name===u);if(d===void 0||d.field===void 0)return r;const C=v===!0?-1:1,k=typeof d.field=="function"?w=>d.field(w):w=>w[d.field];return r.sort((w,b)=>{let c=k(w),p=k(b);return d.rawSort!==void 0?d.rawSort(c,p,w,b)*C:c==null?-1*C:p==null?1*C:d.sort!==void 0?d.sort(c,p,w,b)*C:Le(c)===!0&&Le(p)===!0?(c-p)*C:ot(c)===!0&&ot(p)===!0?Hl(c,p)*C:typeof c=="boolean"&&typeof p=="boolean"?(c-p)*C:([c,p]=[c,p].map(P=>(P+"").toLocaleString().toLowerCase()),c<p?-1*C:c===p?0:C)})});function o(r){let u=e.columnSortOrder;if(fl(r)===!0)r.sortOrder&&(u=r.sortOrder),r=r.name;else{const C=n.value.find(k=>k.name===r);C!==void 0&&C.sortOrder&&(u=C.sortOrder)}let{sortBy:v,descending:d}=t.value;v!==r?(v=r,d=u==="da"):e.binaryStateSort===!0?d=!d:d===!0?u==="ad"?v=null:d=!1:u==="ad"?d=!0:v=null,i({sortBy:v,descending:d,page:1})}return{columnToSort:s,computedSortMethod:m,sort:o}}const Wl={filter:[String,Object],filterMethod:Function};function Jl(e,t){const n=S(()=>e.filterMethod!==void 0?e.filterMethod:(i,s,m,o)=>{const r=s?s.toLowerCase():"";return i.filter(u=>m.some(v=>{const d=o(v,u)+"";return(d==="undefined"||d==="null"?"":d.toLowerCase()).indexOf(r)!==-1}))});return Q(()=>e.filter,()=>{Ct(()=>{t({page:1},!0)})},{deep:!0}),{computedFilterMethod:n}}function Kl(e,t){for(const n in t)if(t[n]!==e[n])return!1;return!0}function dt(e){return e.page<1&&(e.page=1),e.rowsPerPage!==void 0&&e.rowsPerPage<1&&(e.rowsPerPage=0),e}const Zl={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function Xl(e,t){const{props:n,emit:i}=e,s=I(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:n.rowsPerPageOptions.length!==0?n.rowsPerPageOptions[0]:5},n.pagination)),m=S(()=>{const d=n["onUpdate:pagination"]!==void 0?{...s.value,...n.pagination}:s.value;return dt(d)}),o=S(()=>m.value.rowsNumber!==void 0);function r(d){u({pagination:d,filter:n.filter})}function u(d={}){Ct(()=>{i("request",{pagination:d.pagination||m.value,filter:d.filter||n.filter,getCellValue:t})})}function v(d,C){const k=dt({...m.value,...d});if(Kl(m.value,k)===!0){o.value===!0&&C===!0&&r(k);return}if(o.value===!0){r(k);return}n.pagination!==void 0&&n["onUpdate:pagination"]!==void 0?i("update:pagination",k):s.value=k}return{innerPagination:s,computedPagination:m,isServerSide:o,requestServerInteraction:u,setPagination:v}}function ea(e,t,n,i,s,m){const{props:o,emit:r,proxy:{$q:u}}=e,v=S(()=>i.value===!0?n.value.rowsNumber||0:m.value),d=S(()=>{const{page:q,rowsPerPage:N}=n.value;return(q-1)*N}),C=S(()=>{const{page:q,rowsPerPage:N}=n.value;return q*N}),k=S(()=>n.value.page===1),w=S(()=>n.value.rowsPerPage===0?1:Math.max(1,Math.ceil(v.value/n.value.rowsPerPage))),b=S(()=>C.value===0?!0:n.value.page>=w.value),c=S(()=>(o.rowsPerPageOptions.includes(t.value.rowsPerPage)?o.rowsPerPageOptions:[t.value.rowsPerPage].concat(o.rowsPerPageOptions)).map(N=>({label:N===0?u.lang.table.allRows:""+N,value:N})));Q(w,(q,N)=>{if(q===N)return;const ce=n.value.page;q&&!ce?s({page:1}):q<ce&&s({page:q})});function p(){s({page:1})}function P(){const{page:q}=n.value;q>1&&s({page:q-1})}function F(){const{page:q,rowsPerPage:N}=n.value;C.value>0&&q*N<v.value&&s({page:q+1})}function R(){s({page:w.value})}return o["onUpdate:pagination"]!==void 0&&r("update:pagination",{...n.value}),{firstRowIndex:d,lastRowIndex:C,isFirstPage:k,isLastPage:b,pagesNumber:w,computedRowsPerPageOptions:c,computedRowsNumber:v,firstPage:p,prevPage:P,nextPage:F,lastPage:R}}const ta={selection:{type:String,default:"none",validator:e=>["single","multiple","none"].includes(e)},selected:{type:Array,default:()=>[]}},la=["update:selected","selection"];function aa(e,t,n,i){const s=S(()=>{const b={};return e.selected.map(i.value).forEach(c=>{b[c]=!0}),b}),m=S(()=>e.selection!=="none"),o=S(()=>e.selection==="single"),r=S(()=>e.selection==="multiple"),u=S(()=>n.value.length!==0&&n.value.every(b=>s.value[i.value(b)]===!0)),v=S(()=>u.value!==!0&&n.value.some(b=>s.value[i.value(b)]===!0)),d=S(()=>e.selected.length);function C(b){return s.value[b]===!0}function k(){t("update:selected",[])}function w(b,c,p,P){t("selection",{rows:c,added:p,keys:b,evt:P});const F=o.value===!0?p===!0?c:[]:p===!0?e.selected.concat(c):e.selected.filter(R=>b.includes(i.value(R))===!1);t("update:selected",F)}return{hasSelectionMode:m,singleSelection:o,multipleSelection:r,allRowsSelected:u,someRowsSelected:v,rowsSelectedNumber:d,isRowSelected:C,clearSelection:k,updateSelection:w}}function ct(e){return Array.isArray(e)?e.slice():[]}const ra={expanded:Array},na=["update:expanded"];function oa(e,t){const n=I(ct(e.expanded));Q(()=>e.expanded,o=>{n.value=ct(o)});function i(o){return n.value.includes(o)}function s(o){e.expanded!==void 0?t("update:expanded",o):n.value=o}function m(o,r){const u=n.value.slice(),v=u.indexOf(o);r===!0?v===-1&&(u.push(o),s(u)):v!==-1&&(u.splice(v,1),s(u))}return{isRowExpanded:i,setExpanded:s,updateExpanded:m}}const sa={visibleColumns:Array};function ua(e,t,n){const i=S(()=>{if(e.columns!==void 0)return e.columns;const r=e.rows[0];return r!==void 0?Object.keys(r).map(u=>({name:u,label:u.toUpperCase(),field:u,align:Le(r[u])?"right":"left",sortable:!0})):[]}),s=S(()=>{const{sortBy:r,descending:u}=t.value;return(e.visibleColumns!==void 0?i.value.filter(d=>d.required===!0||e.visibleColumns.includes(d.name)===!0):i.value).map(d=>{const C=d.align||"right",k=`text-${C}`;return{...d,align:C,__iconClass:`q-table__sort-icon q-table__sort-icon--${C}`,__thClass:k+(d.headerClasses!==void 0?" "+d.headerClasses:"")+(d.sortable===!0?" sortable":"")+(d.name===r?` sorted ${u===!0?"sort-desc":""}`:""),__tdStyle:d.style!==void 0?typeof d.style!="function"?()=>d.style:d.style:()=>null,__tdClass:d.classes!==void 0?typeof d.classes!="function"?()=>k+" "+d.classes:w=>k+" "+d.classes(w):()=>k}})}),m=S(()=>{const r={};return s.value.forEach(u=>{r[u.name]=u}),r}),o=S(()=>e.tableColspan!==void 0?e.tableColspan:s.value.length+(n.value===!0?1:0));return{colList:i,computedCols:s,computedColsMap:m,computedColspan:o}}const we="q-table__bottom row items-center",Dt={};qt.forEach(e=>{Dt[e]={}});var ia=X({name:"QTable",props:{rows:{type:Array,default:()=>[]},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:e=>["horizontal","vertical","cell","none"].includes(e)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{default:void 0},...Dt,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...ze,...Ql,...sa,...Wl,...Zl,...ra,...ta,...Yl},emits:["request","virtualScroll",...jl,...na,...la],setup(e,{slots:t,emit:n}){const i=ne(),{proxy:{$q:s}}=i,m=He(e,s),{inFullscreen:o,toggleFullscreen:r}=zl(),u=S(()=>typeof e.rowKey=="function"?e.rowKey:l=>l[e.rowKey]),v=I(null),d=I(null),C=S(()=>e.grid!==!0&&e.virtualScroll===!0),k=S(()=>" q-table__card"+(m.value===!0?" q-table__card--dark q-dark":"")+(e.square===!0?" q-table--square":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")),w=S(()=>`q-table__container q-table--${e.separator}-separator column no-wrap`+(e.grid===!0?" q-table--grid":k.value)+(m.value===!0?" q-table--dark":"")+(e.dense===!0?" q-table--dense":"")+(e.wrapCells===!1?" q-table--no-wrap":"")+(o.value===!0?" fullscreen scroll":"")),b=S(()=>w.value+(e.loading===!0?" q-table--loading":""));Q(()=>e.tableStyle+e.tableClass+e.tableHeaderStyle+e.tableHeaderClass+w.value,()=>{C.value===!0&&d.value!==null&&d.value.reset()});const{innerPagination:c,computedPagination:p,isServerSide:P,requestServerInteraction:F,setPagination:R}=Xl(i,te),{computedFilterMethod:q}=Jl(e,R),{isRowExpanded:N,setExpanded:ce,updateExpanded:Vt}=oa(e,n),Pe=S(()=>{let l=e.rows;if(P.value===!0||l.length===0)return l;const{sortBy:_,descending:U}=p.value;return e.filter&&(l=q.value(l,e.filter,j.value,te)),Ft.value!==null&&(l=Ot.value(e.rows===l?l.slice():l,_,U)),l}),Ye=S(()=>Pe.value.length),Y=S(()=>{let l=Pe.value;if(P.value===!0)return l;const{rowsPerPage:_}=p.value;return _!==0&&(fe.value===0&&e.rows!==l?l.length>me.value&&(l=l.slice(0,me.value)):l=l.slice(fe.value,me.value)),l}),{hasSelectionMode:ee,singleSelection:Rt,multipleSelection:Ge,allRowsSelected:Nt,someRowsSelected:We,rowsSelectedNumber:xe,isRowSelected:De,clearSelection:$t,updateSelection:ve}=aa(e,n,Y,u),{colList:At,computedCols:j,computedColsMap:Je,computedColspan:Ke}=ua(e,p,ee),{columnToSort:Ft,computedSortMethod:Ot,sort:Ve}=Gl(e,p,At,R),{firstRowIndex:fe,lastRowIndex:me,isFirstPage:Re,isLastPage:Ne,pagesNumber:be,computedRowsPerPageOptions:Bt,computedRowsNumber:ge,firstPage:$e,prevPage:Ae,nextPage:Fe,lastPage:Oe}=ea(i,c,p,P,R,Ye),It=S(()=>Y.value.length===0),Mt=S(()=>{const l={};return qt.forEach(_=>{l[_]=e[_]}),l.virtualScrollItemSize===void 0&&(l.virtualScrollItemSize=e.dense===!0?28:48),l});function Et(){C.value===!0&&d.value.reset()}function Lt(){if(e.grid===!0)return el();const l=e.hideHeader!==!0?lt:null;if(C.value===!0){const U=t["top-row"],h=t["bottom-row"],T={default:V=>Xe(V.item,t.body,V.index)};if(U!==void 0){const V=g("tbody",U({cols:j.value}));T.before=l===null?()=>V:()=>[l()].concat(V)}else l!==null&&(T.before=l);return h!==void 0&&(T.after=()=>g("tbody",h({cols:j.value}))),g(Ml,{ref:d,class:e.tableClass,style:e.tableStyle,...Mt.value,scrollTarget:e.virtualScrollTarget,items:Y.value,type:"__qtable",tableColspan:Ke.value,onVirtualScroll:jt},T)}const _=[zt()];return l!==null&&_.unshift(l()),xt({class:["q-table__middle scroll",e.tableClass],style:e.tableStyle},_)}function Qt(l,_){if(d.value!==null){d.value.scrollTo(l,_);return}l=parseInt(l,10);const U=v.value.querySelector(`tbody tr:nth-of-type(${l+1})`);if(U!==null){const h=v.value.querySelector(".q-table__middle.scroll"),T=U.offsetTop-e.virtualScrollStickySizeStart,V=T<h.scrollTop?"decrease":"increase";h.scrollTop=T,n("virtualScroll",{index:l,from:0,to:c.value.rowsPerPage-1,direction:V})}}function jt(l){n("virtualScroll",l)}function Ze(){return[g(Ll,{class:"q-table__linear-progress",color:e.color,dark:m.value,indeterminate:!0,trackColor:"transparent"})]}function Xe(l,_,U){const h=u.value(l),T=De(h);if(_!==void 0)return _(et({key:h,row:l,pageIndex:U,__trClass:T?"selected":""}));const V=t["body-cell"],D=j.value.map(B=>{const _e=t[`body-cell-${B.name}`],Se=_e!==void 0?_e:V;return Se!==void 0?Se(Ht({key:h,row:l,pageIndex:U,col:B})):g("td",{class:B.__tdClass(l),style:B.__tdStyle(l)},te(B,l))});if(ee.value===!0){const B=t["body-selection"],_e=B!==void 0?B(Yt({key:h,row:l,pageIndex:U})):[g(Me,{modelValue:T,color:e.color,dark:m.value,dense:e.dense,"onUpdate:modelValue":(Se,tl)=>{ve([h],[l],Se,tl)}})];D.unshift(g("td",{class:"q-table--col-auto-width"},_e))}const z={key:h,class:{selected:T}};return e.onRowClick!==void 0&&(z.class["cursor-pointer"]=!0,z.onClick=B=>{n("RowClick",B,l,U)}),e.onRowDblclick!==void 0&&(z.class["cursor-pointer"]=!0,z.onDblclick=B=>{n("RowDblclick",B,l,U)}),e.onRowContextmenu!==void 0&&(z.class["cursor-pointer"]=!0,z.onContextmenu=B=>{n("RowContextmenu",B,l,U)}),g("tr",z,D)}function zt(){const l=t.body,_=t["top-row"],U=t["bottom-row"];let h=Y.value.map((T,V)=>Xe(T,l,V));return _!==void 0&&(h=_({cols:j.value}).concat(h)),U!==void 0&&(h=h.concat(U({cols:j.value}))),g("tbody",h)}function et(l){return Be(l),l.cols=l.cols.map(_=>oe({..._},"value",()=>te(_,l.row))),l}function Ht(l){return Be(l),oe(l,"value",()=>te(l.col,l.row)),l}function Yt(l){return Be(l),l}function Be(l){Object.assign(l,{cols:j.value,colsMap:Je.value,sort:Ve,rowIndex:fe.value+l.pageIndex,color:e.color,dark:m.value,dense:e.dense}),ee.value===!0&&oe(l,"selected",()=>De(l.key),(_,U)=>{ve([l.key],[l.row],_,U)}),oe(l,"expand",()=>N(l.key),_=>{Vt(l.key,_)})}function te(l,_){const U=typeof l.field=="function"?l.field(_):_[l.field];return l.format!==void 0?l.format(U,_):U}const le=S(()=>({pagination:p.value,pagesNumber:be.value,isFirstPage:Re.value,isLastPage:Ne.value,firstPage:$e,prevPage:Ae,nextPage:Fe,lastPage:Oe,inFullscreen:o.value,toggleFullscreen:r}));function Gt(){const l=t.top,_=t["top-left"],U=t["top-right"],h=t["top-selection"],T=ee.value===!0&&h!==void 0&&xe.value>0,V="q-table__top relative-position row items-center";if(l!==void 0)return g("div",{class:V},[l(le.value)]);let D;if(T===!0?D=h(le.value).slice():(D=[],_!==void 0?D.push(g("div",{class:"q-table__control"},[_(le.value)])):e.title&&D.push(g("div",{class:"q-table__control"},[g("div",{class:["q-table__title",e.titleClass]},e.title)]))),U!==void 0&&(D.push(g("div",{class:"q-table__separator col"})),D.push(g("div",{class:"q-table__control"},[U(le.value)]))),D.length!==0)return g("div",{class:V},D)}const tt=S(()=>We.value===!0?null:Nt.value);function lt(){const l=Wt();return e.loading===!0&&t.loading===void 0&&l.push(g("tr",{class:"q-table__progress"},[g("th",{class:"relative-position",colspan:Ke.value},Ze())])),g("thead",l)}function Wt(){const l=t.header,_=t["header-cell"];if(l!==void 0)return l(Ie({header:!0})).slice();const U=j.value.map(h=>{const T=t[`header-cell-${h.name}`],V=T!==void 0?T:_,D=Ie({col:h});return V!==void 0?V(D):g(Al,{key:h.name,props:D},()=>h.label)});if(Rt.value===!0&&e.grid!==!0)U.unshift(g("th",{class:"q-table--col-auto-width"}," "));else if(Ge.value===!0){const h=t["header-selection"],T=h!==void 0?h(Ie({})):[g(Me,{color:e.color,modelValue:tt.value,dark:m.value,dense:e.dense,"onUpdate:modelValue":at})];U.unshift(g("th",{class:"q-table--col-auto-width"},T))}return[g("tr",{class:e.tableHeaderClass,style:e.tableHeaderStyle},U)]}function Ie(l){return Object.assign(l,{cols:j.value,sort:Ve,colsMap:Je.value,color:e.color,dark:m.value,dense:e.dense}),Ge.value===!0&&oe(l,"selected",()=>tt.value,at),l}function at(l){We.value===!0&&(l=!1),ve(Y.value.map(u.value),Y.value,l)}const ye=S(()=>{const l=[e.iconFirstPage||s.iconSet.table.firstPage,e.iconPrevPage||s.iconSet.table.prevPage,e.iconNextPage||s.iconSet.table.nextPage,e.iconLastPage||s.iconSet.table.lastPage];return s.lang.rtl===!0?l.reverse():l});function Jt(){if(e.hideBottom===!0)return;if(It.value===!0){if(e.hideNoData===!0)return;const U=e.loading===!0?e.loadingLabel||s.lang.table.loading:e.filter?e.noResultsLabel||s.lang.table.noResults:e.noDataLabel||s.lang.table.noData,h=t["no-data"],T=h!==void 0?[h({message:U,icon:s.iconSet.table.warning,filter:e.filter})]:[g(H,{class:"q-table__bottom-nodata-icon",name:s.iconSet.table.warning}),U];return g("div",{class:we+" q-table__bottom--nodata"},T)}const l=t.bottom;if(l!==void 0)return g("div",{class:we},[l(le.value)]);const _=e.hideSelectedBanner!==!0&&ee.value===!0&&xe.value>0?[g("div",{class:"q-table__control"},[g("div",[(e.selectedRowsLabel||s.lang.table.selectedRecords)(xe.value)])])]:[];if(e.hidePagination!==!0)return g("div",{class:we+" justify-end"},Zt(_));if(_.length!==0)return g("div",{class:we},_)}function Kt(l){R({page:1,rowsPerPage:l.value})}function Zt(l){let _;const{rowsPerPage:U}=p.value,h=e.paginationLabel||s.lang.table.pagination,T=t.pagination,V=e.rowsPerPageOptions.length>1;if(l.push(g("div",{class:"q-table__separator col"})),V===!0&&l.push(g("div",{class:"q-table__control"},[g("span",{class:"q-table__bottom-item"},[e.rowsPerPageLabel||s.lang.table.recordsPerPage]),g(de,{class:"q-table__select inline q-table__bottom-item",color:e.color,modelValue:U,options:Bt.value,displayValue:U===0?s.lang.table.allRows:U,dark:m.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":Kt})])),T!==void 0)_=T(le.value);else if(_=[g("span",U!==0?{class:"q-table__bottom-item"}:{},[U?h(fe.value+1,Math.min(me.value,ge.value),ge.value):h(1,Ye.value,ge.value)])],U!==0&&be.value>1){const D={color:e.color,round:!0,dense:!0,flat:!0};e.dense===!0&&(D.size="sm"),be.value>2&&_.push(g(L,{key:"pgFirst",...D,icon:ye.value[0],disable:Re.value,onClick:$e})),_.push(g(L,{key:"pgPrev",...D,icon:ye.value[1],disable:Re.value,onClick:Ae}),g(L,{key:"pgNext",...D,icon:ye.value[2],disable:Ne.value,onClick:Fe})),be.value>2&&_.push(g(L,{key:"pgLast",...D,icon:ye.value[3],disable:Ne.value,onClick:Oe}))}return l.push(g("div",{class:"q-table__control"},_)),l}function Xt(){const l=e.gridHeader===!0?[g("table",{class:"q-table"},[lt()])]:e.loading===!0&&t.loading===void 0?Ze():void 0;return g("div",{class:"q-table__middle"},l)}function el(){const l=t.item!==void 0?t.item:_=>{const U=_.cols.map(T=>g("div",{class:"q-table__grid-item-row"},[g("div",{class:"q-table__grid-item-title"},[T.label]),g("div",{class:"q-table__grid-item-value"},[T.value])]));if(ee.value===!0){const T=t["body-selection"],V=T!==void 0?T(_):[g(Me,{modelValue:_.selected,color:e.color,dark:m.value,dense:e.dense,"onUpdate:modelValue":(D,z)=>{ve([_.key],[_.row],D,z)}})];U.unshift(g("div",{class:"q-table__grid-item-row"},V),g(_l,{dark:m.value}))}const h={class:["q-table__grid-item-card"+k.value,e.cardClass],style:e.cardStyle};return(e.onRowClick!==void 0||e.onRowDblclick!==void 0)&&(h.class[0]+=" cursor-pointer",e.onRowClick!==void 0&&(h.onClick=T=>{n("RowClick",T,_.row,_.pageIndex)}),e.onRowDblclick!==void 0&&(h.onDblclick=T=>{n("RowDblclick",T,_.row,_.pageIndex)})),g("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(_.selected===!0?" q-table__grid-item--selected":"")},[g("div",h,U)])};return g("div",{class:["q-table__grid-content row",e.cardContainerClass],style:e.cardContainerStyle},Y.value.map((_,U)=>l(et({key:u.value(_),row:_,pageIndex:U}))))}return Object.assign(i.proxy,{requestServerInteraction:F,setPagination:R,firstPage:$e,prevPage:Ae,nextPage:Fe,lastPage:Oe,isRowSelected:De,clearSelection:$t,isRowExpanded:N,setExpanded:ce,sort:Ve,resetVirtualScroll:Et,scrollTo:Qt,getCellValue:te}),ml(i.proxy,{filteredSortedRows:()=>Pe.value,computedRows:()=>Y.value,computedRowsNumber:()=>ge.value}),()=>{const l=[Gt()],_={ref:v,class:b.value};return e.grid===!0?l.push(Xt()):Object.assign(_,{class:[_.class,e.cardClass],style:e.cardStyle}),l.push(Lt(),Jt()),e.loading===!0&&t.loading!==void 0&&l.push(t.loading()),g("div",_,l)}}});function vt(e){setTimeout(()=>{window.URL.revokeObjectURL(e.href)},1e4),e.remove()}function da(e,t,n={}){const{mimeType:i,byteOrderMark:s,encoding:m}=typeof n=="string"?{mimeType:n}:n,o=m!==void 0?new TextEncoder(m).encode([t]):t,r=s!==void 0?[s,o]:[o],u=new Blob(r,{type:i||"application/octet-stream"}),v=document.createElement("a");v.href=window.URL.createObjectURL(u),v.setAttribute("download",e),typeof v.download=="undefined"&&v.setAttribute("target","_blank"),v.classList.add("hidden"),v.style.position="fixed",document.body.appendChild(v);try{return v.click(),vt(v),!0}catch(d){return vt(v),d}}const ft=()=>new Date(Date.UTC(new Date().getUTCFullYear(),new Date().getUTCMonth(),new Date().getUTCDate(),new Date().getUTCHours(),new Date().getUTCMinutes(),new Date().getUTCSeconds())),mt=e=>new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),Ue=e=>e.toISOString().split("T")[0],bt=e=>new Date(e);const ca=K({__name:"UserActivityTable",setup(e){const t=gt(),n=I(null),i=I([{name:"activityId",label:"ID",align:"left",field:"activityId",sortable:!1},{name:"date",label:"Date",align:"left",field:"date",sortable:!0},{name:"time",label:"Time",align:"left",field:"time",sortable:!1},{name:"performerUserFullName",label:"Performer User",align:"left",field:"performerUserFullName",sortable:!1},{name:"relatedUserFullName",label:"Related User",align:"left",field:"relatedUserFullName",sortable:!1},{name:"action",label:"Action",align:"left",field:"action",sortable:!1},{name:"description",label:"Description",align:"left",field:"description",sortable:!1}]),s=["date","time","performerUserFullName","relatedUserFullName","action","description"],m=ft(),o=mt(m),r=I({term:"",timeframe:"today",dateStart:Ue(o),dateEnd:Ue(m),activity:"",searchColumns:["action","description"],performerUserId:t.allPerformerUserIds,relatedUserId:t.allRelatedUserIds}),u=S(()=>t.activity.map(w=>({value:w.performerUserId,label:w.performerUserFullName})).filter((w,b,c)=>b===c.findIndex(p=>p.label===w.label&&p.value===w.value))),v=S(()=>t.activity.map(w=>({value:w.relatedUserId,label:w.relatedUserFullName})).filter((w,b,c)=>b===c.findIndex(p=>p.label===w.label&&p.value===w.value))),d=w=>{r.value.timeframe=w;const b=ft(),c=mt(b);let p,P;switch(w){case"today":p=c,P=new Date(Date.UTC(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),23,59,59));break;case"yesterday":p=new Date(Date.UTC(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()-1)),P=new Date(Date.UTC(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),0,0,-1));break;case"monthToDate":p=new Date(Date.UTC(b.getUTCFullYear(),b.getUTCMonth(),1)),P=b;break;case"lastMonth":p=new Date(Date.UTC(b.getUTCFullYear(),b.getUTCMonth()-1,1)),P=new Date(Date.UTC(b.getUTCFullYear(),b.getUTCMonth(),0));break;case"custom":p=new Date(r.value.dateStart),P=new Date(r.value.dateEnd),isNaN(p.getTime())||isNaN(P.getTime())?pe({message:"Invalid custom date range",color:"negative",icon:"warning"}):P<p&&pe({message:"End date cannot be before start date",color:"negative",icon:"warning"});break}r.value.dateStart=Ue(p),r.value.dateEnd=Ue(P)},C=S(()=>{const w=bt(r.value.dateStart),b=bt(r.value.dateEnd);return t.activity.filter(c=>{var q,N;const p=new Date(c.createdAt),P=p>=w&&p<=b,F=!((q=r.value.performerUserId)!=null&&q.length)||r.value.performerUserId.includes(c.performerUserId),R=!((N=r.value.relatedUserId)!=null&&N.length)||r.value.relatedUserId.includes(c.relatedUserId);return P&&F&&R})}),k=()=>{if(!n.value)return;const w=n.value.filteredSortedRows,b=[i.value.map(R=>st(R.label))].concat(w.map(R=>i.value.map(q=>st(typeof q.field=="function"?q.field(R):R[q.field===void 0?q.name:q.field])).join(","))).join(`\r
`),c=new Date,P=`User Activity ${`${c.getFullYear()}-${c.getMonth()+1}-${c.getDate()} ${c.getHours()}-${c.getMinutes()}-${c.getSeconds()}`}.csv`;da(P,b,"text/csv")!==!0?pe({message:"Browser denied file download...",color:"negative",icon:"warning"}):pe({message:"File downloaded successfully...",color:"positive",icon:"download"})};return(w,b)=>(A(),M(J,null,{default:f(()=>[a(ia,{ref_key:"tableRef",ref:n,rows:C.value,columns:i.value,"row-key":"activityId","visible-columns":s,filter:r.value.term,"rows-per-page-options":[-1],"hide-pagination":"","virtual-scroll":"",class:"header-table",style:{height:"60vh",overflow:"auto",margin:"0.4rem"}},{top:f(()=>[a(G,{class:"text-h3"},{default:f(()=>[x(" Activity ")]),_:1}),a(he),a(kt,{class:"bg-blue text-white q-ma-md"},{default:f(()=>[a(ue,{icon:"priority_high"}),x(" Dates in UTC ")]),_:1}),a(Ce,null,{default:f(()=>[ie("div",null,[a(Cl,{outline:""},{default:f(()=>[a(L,{outline:"",label:"Today",color:r.value.timeframe==="today"?"blue":"",onClick:b[0]||(b[0]=c=>d("today"))},null,8,["color"]),a(L,{outline:"",label:"Yesterday",color:r.value.timeframe==="yesterday"?"blue":"",onClick:b[1]||(b[1]=c=>d("yesterday"))},null,8,["color"]),a(L,{outline:"",label:"Month to Date",color:r.value.timeframe==="monthToDate"?"blue":"",onClick:b[2]||(b[2]=c=>d("monthToDate"))},null,8,["color"]),a(L,{outline:"",label:"Last Month",color:r.value.timeframe==="lastMonth"?"blue":"",onClick:b[3]||(b[3]=c=>d("lastMonth"))},null,8,["color"]),a(Sl,{outline:"",label:"Custom",color:r.value.timeframe==="custom"?"blue":"",onBeforeShow:b[6]||(b[6]=c=>d("custom"))},{default:f(()=>[a(O,{outlined:"",debounce:"300",modelValue:r.value.dateStart,"onUpdate:modelValue":b[4]||(b[4]=c=>r.value.dateStart=c),label:"Date Start",type:"date"},null,8,["modelValue"]),a(O,{outlined:"",debounce:"300",modelValue:r.value.dateEnd,"onUpdate:modelValue":b[5]||(b[5]=c=>r.value.dateEnd=c),label:"Date End",type:"date"},null,8,["modelValue"])]),_:1},8,["color"])]),_:1})]),a(he),a(L,{color:"primary",icon:"download",label:"Download CSV",onClick:k})]),_:1}),a(Ce,null,{default:f(()=>[a(he),a(O,{outlined:"",debounce:"300",modelValue:r.value.term,"onUpdate:modelValue":b[7]||(b[7]=c=>r.value.term=c),clearable:"",label:"Search on description"},{append:f(()=>[a(H,{name:"search"})]),_:1},8,["modelValue"])]),_:1}),a(Ce,null,{default:f(()=>[a(de,{outlined:"",multiple:"",style:{"min-width":"120px"},dense:"","emit-value":"","map-options":"",modelValue:r.value.performerUserId,"onUpdate:modelValue":b[8]||(b[8]=c=>r.value.performerUserId=c),options:u.value,label:"Performer",behavior:"dialog","use-chips":""},null,8,["modelValue","options"]),a(de,{style:{"min-width":"120px"},outlined:"","emit-value":"",dense:"","map-options":"",label:"Related",multiple:"",modelValue:r.value.relatedUserId,"onUpdate:modelValue":b[9]||(b[9]=c=>r.value.relatedUserId=c),options:v.value,"use-chips":"",behavior:"dialog"},null,8,["modelValue","options"])]),_:1})]),body:f(c=>[a($l,{props:c},{default:f(()=>[a(ae,{key:"date",props:c},{default:f(()=>[x($(c.row.date),1)]),_:2},1032,["props"]),a(ae,{key:"time",props:c},{default:f(()=>[x($(c.row.time),1)]),_:2},1032,["props"]),a(ae,{key:"performerUserFullName",props:c},{default:f(()=>[x($(c.row.performerUserFullName),1)]),_:2},1032,["props"]),a(ae,{key:"relatedUserFullName",props:c},{default:f(()=>[ie("span",{class:bl({"text-grey":!c.row.relatedUserFullName})},$(c.row.relatedUserFullName||"No one"),3)]),_:2},1032,["props"]),a(ae,{key:"action",props:c},{default:f(()=>[c.row.action==="Edit Settings"?(A(),M(ue,{key:0,icon:"edit"})):c.row.action==="Update User Group"?(A(),M(ue,{key:1,icon:"edit"})):Ee("",!0),x(" "+$(c.row.action),1)]),_:2},1032,["props"]),a(ae,{key:"description",props:c},{default:f(()=>[x($(c.row.description),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"])]),_:1}))}});var va=St(ca,[["__scopeId","data-v-54661930"]]);const fa={class:"row"},ma={class:"col-9"},ha=K({__name:"UsersPage",setup(e){const t=Z(),n=ke();return je(()=>{n.readSettings(),t.readAllUsers()}),(i,s)=>(A(),yt(_t,null,[a(Tl),a(kl),a(Ul,{class:"row-container"},{default:f(()=>[a(wl,null,{default:f(()=>[a(Ce,null,{default:f(()=>[a(Qe,null,{default:f(()=>[x("Users \xBB "+$(y(t).selectedUser.givenName)+" "+$(y(t).selectedUser.surname),1)]),_:1}),a(Tt,null,{default:f(()=>[a(L,{icon:y(t).createMode?"close":"add",label:y(t).createMode?"Cancel Create":"Create User",onClick:s[0]||(s[0]=m=>{(y(t).createMode=!y(t).createMode)&&(y(t).editMode=!1)})},null,8,["icon","label"]),a(L,{icon:y(t).editMode?"close":"edit",label:y(t).editMode?"Cancel Edit":"Edit User",onClick:s[1]||(s[1]=m=>{(y(t).editMode=!y(t).editMode)&&(y(t).createMode=!1)})},null,8,["icon","label"])]),_:1})]),_:1})]),_:1}),ie("div",fa,[a(Vl),ie("div",ma,[a(Nl),a(va)])])]),_:1})],64))}});export{ha as default};
